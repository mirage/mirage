<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mirage (mirage.Mirage)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">mirage</a> &#x00BB; Mirage</nav><header class="odoc-preamble"><h1>Module <code><span>Mirage</span></code></h1><p><em>Release v4.9.0</em></p></header><nav class="odoc-toc"><ul><li><a href="#what-is-mirageos?">What is MirageOS?</a><ul><li><a href="#is-everything-really-written-in-ocaml?">Is everything really written in OCaml?</a></li><li><a href="#mirageos-as-a-cross-compilator">MirageOS as a cross-compilator</a><ul><li><a href="#mirageos-3.x">MirageOS 3.x</a><ul><li><a href="#mirageos-4.x">MirageOS 4.x</a></li></ul></li></ul></li></ul></li><li><a href="#mirageos-edsl">MirageOS eDSL</a><ul><li><a href="#combinators">Combinators</a></li><li><a href="#keys">Keys</a></li><li><a href="#pkg">Package dependencies</a></li><li><a href="#app">Application Builder</a></li><li><a href="#devices">Devices</a></li><li><a href="#jobs">Jobs</a></li><li><a href="#general-mirage-devices">General mirage devices</a></li><li><a href="#sleep">Sleep</a></li><li><a href="#posix-time">Posix time</a></li><li><a href="#monotonic-time">Monotonic time</a></li><li><a href="#log-reporters">Log reporters</a></li><li><a href="#random">Random</a></li><li><a href="#block-devices">Block devices</a></li><li><a href="#static-key/value-stores">Static key/value stores</a></li><li><a href="#network-interfaces">Network interfaces</a></li><li><a href="#ethernet-configuration">Ethernet configuration</a></li><li><a href="#arp-configuration">ARP configuration</a></li><li><a href="#ip-configuration">IP configuration</a></li><li><a href="#udp-configuration">UDP configuration</a></li><li><a href="#tcp-configuration">TCP configuration</a></li><li><a href="#network-stack-configuration">Network stack configuration</a><ul><li><a href="#dual-ipv4-and-ipv6">Dual IPv4 and IPv6</a></li></ul></li><li><a href="#resolver-configuration">Resolver configuration</a></li><li><a href="#happy-eyeballs">Happy-eyeballs</a></li><li><a href="#dns-client">DNS client</a></li><li><a href="#syslog-configuration">Syslog configuration</a></li><li><a href="#conduit-configuration">Conduit configuration</a></li><li><a href="#mimic-devices">Mimic devices</a></li><li><a href="#http-configuration">HTTP configuration</a></li><li><a href="#argv-configuration">Argv configuration</a></li><li><a href="#git-client-configuration">Git client configuration</a></li><li><a href="#other-devices">Other devices</a></li><li><a href="#application-registering">Application registering</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="what-is-mirageos?"><a href="#what-is-mirageos?" class="anchor"></a>What is MirageOS?</h2><p>MirageOS is a library operating system that can build standalone unikernels on various platforms. More precisely, the architecture can be divided into:</p><ul><li><em>operating system libraries</em> that implement kernel and protocol functionality, ranging from low-level network card drivers to a full reimplementation of the TLS protocol, through to a reimplementation of the Git protocol to store versioned data.</li></ul><ul><li>A set of <em>typed signatures</em> to make sure these libraries are consistent and can interoperate. As all the library are almost all pure OCaml code, we have defined <em>a set of OCaml module types</em> that encode these conventions in a statically enforcable way. We make no compatibility guarantees at the C level, but compile those on a best-effort basis.</li></ul><ul><li>Finally, MirageOS is also a <em>metaprogramming compiler</em> that generates OCaml code. It takes as input: the OCaml source code of a program and all of its dependencies, the full description of the deployment target, including configuration values (like the HTTP port to listen on, or the private key or the service being deployed). The `mirage`CLI tool uses all of these to <em>generate a executable unikernel</em>: a specialised binary artefact containing only the code what is needed to run on the given deployment platform and no more.</li></ul><p>It is possible to write high-level MirageOS applications, such as HTTPS, email or CalDAV servers which can be deployed on very heterogenous and embedded platforms by changing only a few compilation parameters. The supported platforms range from minimal virtual machines running on cloud providers, or processes running inside Docker containers configured with a tight security profile. In general, these platform do not have a full POSIX environment; MirageOS does not try to emulate POSIX and focuses on providing a small, well-defined, typed interface with the system components. The nearest equivalent to the MirageOS approach is the WASI (wasi.dev) set of interfaces for WebAssembly.</p><h3 id="is-everything-really-written-in-ocaml?"><a href="#is-everything-really-written-in-ocaml?" class="anchor"></a>Is everything really written in OCaml?</h3><p>While most of the code is written in OCaml, a typed, high-level language with many good safety properties, there are pieces of MirageOS which are still written in C. These bits can be separated in three categories:</p><ul><li>The OCaml runtime is written in C. It needs to be ported to the platform that MirageOS is trying to target, which do not support POSIX. Hence, the first component to port to a new platform is the OCaml runtime.</li></ul><ul><li>The low-level device drivers (network, console, clock, etc) also need some C bits.</li></ul><ul><li>The base usual C bindings; some libraries are widely used and (unfortunately) very hard (but not impossible) to replace them completely without taking a big performance hit or having to trust code without much real-world usages. This is the case for low-level bit handling for crypto code (even if we try to make sure allocation is alway handled by the OCaml runtime) as well as arbitrary precision numeric computation (e.g. gmp). Ideally we could image rewriting all of these libraries in OCaml if we had an infinite amount of time in our hands.</li></ul><h3 id="mirageos-as-a-cross-compilator"><a href="#mirageos-as-a-cross-compilator" class="anchor"></a>MirageOS as a cross-compilator</h3><p>The MirageOS compiler is basically a cross-compiler, where the host and target toolchain are identical, but with different flags for the C bindings: for instance, it is necessary to pass <code>-freestanding</code> to <em>all</em> C bindings to not use POSIX headers. The MirageOS compiler also uses a custom linker: eg. not only it needs a custom OCaml's runtime <code>libasmrun.a</code>, but it also needs to run a different linker to generate specialised executable images.</p><p>Historically, the OCaml ecosystem always had partial support for cross-compilation: for instance, the <a href="https://github.com/ocaml-cross/opam-cross-windows">ocaml-cross</a> way of doing it is to duplicate <em>all</em> existing opam pacakges by adding a <code>-windows</code> suffix to their names and dependencies; this allows normal packages and windows packages can be co-installed in the same opam switch.</p><h4 id="mirageos-3.x"><a href="#mirageos-3.x" class="anchor"></a>MirageOS 3.x</h4><p>MirageOS 3.x solves this by duplicating only the packages defining C bindings. It relies on every MirageOS backend registering a set of <code>CFLAGS</code> with <code>pkg-config</code>. Then every bindings uses <code>pkg-config</code> to configure their <code>CFLAGS</code> and <code>ocamlfind</code> to register <a href="https://github.com/ocaml/opam-repository/blob/master/packages/zarith-xen/zarith-xen.1.7/files/mirage-install.sh#L20">link-time predicates</a>, e.g. additional link time options like the name of the C archives. Finally, the final link step is done by querying ocamlfind (using the custom registered predicates) to link the list of dependencies' objects files with the result of OCam compiler's <code>--output-obj</code> option.</p><h5 id="mirageos-4.x"><a href="#mirageos-4.x" class="anchor"></a>MirageOS 4.x</h5><p>MirageOS 4 solves this by relying on <code>dune</code>'s built-in support for cross-compilation. This is done by gathering all the sources of the dependencies locally with <code>opam-monorepo</code>, and by creating a `dune-workspace` file describing the C flags to use in each cross-compilation &quot;context&quot;. Once this is set-up, only one <code>dune build</code> can cross-compile the unikernel target with all its local sources.</p><h2 id="mirageos-edsl"><a href="#mirageos-edsl" class="anchor"></a>MirageOS eDSL</h2><p>The rest of the document describes Functoria, the embedded domain-specific language to be used in <code>config.ml</code> files, to described how the typed libraries have to be assembled.</p><h3 id="combinators"><a href="#combinators" class="anchor"></a>Combinators</h3><div class="odoc-spec"><div class="spec type anchored" id="type-typ"><a href="#type-typ" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a typ</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Type/index.html#type-t">Functoria.Type.t</a></span></span></code></div><div class="spec-doc"><p>The type for values representing module types.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-typ"><a href="#val-typ" class="anchor"></a><code><span><span class="keyword">val</span> typ : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>type t</code> is a value representing the module type <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(@-&gt;)"><a href="#val-(@-&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (@-&gt;) : <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Construct a functor type from a type and an existing functor type. This corresponds to prepending a parameter to the list of functor parameters. For example:</p><pre class="language-ocaml"><code>kv_ro @-&gt; ip @-&gt; kv_ro</code></pre><p>This describes a functor type that accepts two arguments -- a <code>kv_ro</code> and an <code>ip</code> device -- and returns a <code>kv_ro</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-impl"><a href="#type-impl" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a impl</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Impl/index.html#type-t">Functoria.Impl.t</a></span></span></code></div><div class="spec-doc"><p>The type for values representing module implementations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-($)"><a href="#val-($)" class="anchor"></a><code><span><span class="keyword">val</span> ($) : <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>m $ a</code> applies the functor <code>m</code> to the module <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-abstract_impl"><a href="#type-abstract_impl" class="anchor"></a><code><span><span class="keyword">type</span> abstract_impl</span><span> = <a href="../Functoria/Impl/index.html#type-abstract">Functoria.Impl.abstract</a></span></code></div><div class="spec-doc"><p>Same as <a href="#type-impl"><code>impl</code></a> but with hidden type.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dep"><a href="#val-dep" class="anchor"></a><code><span><span class="keyword">val</span> dep : <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-abstract_impl">abstract_impl</a></span></code></div><div class="spec-doc"><p><code>dep t</code> is the (build-time) dependency towards <code>t</code>.</p></div></div><h3 id="keys"><a href="#keys" class="anchor"></a>Keys</h3><div class="odoc-spec"><div class="spec type anchored" id="type-key"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a key</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Key/index.html#type-key">Functoria.Key.key</a></span></span></code></div><div class="spec-doc"><p>The type for configure-time command-line arguments.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-runtime_arg"><a href="#type-runtime_arg" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a runtime_arg</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Runtime_arg/index.html#type-arg">Functoria.Runtime_arg.arg</a></span></span></code></div><div class="spec-doc"><p>The type for runtime command-line arguments.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-runtime_arg"><a href="#val-runtime_arg" class="anchor"></a><code><span><span class="keyword">val</span> runtime_arg : 
  <span><span class="label">pos</span>:<span>(string * int * int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages</span>:<span><a href="../Functoria/Package/index.html#type-t">Functoria.Package.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="../Functoria/Runtime_arg/index.html#type-t">Functoria.Runtime_arg.t</a></span></code></div><div class="spec-doc"><p><code>runtime_arg ~pos ?packages v</code> is the runtime argument pointing to the value <code>v</code>. <code>pos</code> is expected to be <code>__POS__</code>. <code>packages</code> specifies in which opam package the value <code>v</code> is defined.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-abstract_key"><a href="#type-abstract_key" class="anchor"></a><code><span><span class="keyword">type</span> abstract_key</span><span> = <a href="../Functoria/Key/index.html#type-t">Functoria.Key.t</a></span></code></div><div class="spec-doc"><p>The type for abstract keys.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-context"><a href="#type-context" class="anchor"></a><code><span><span class="keyword">type</span> context</span><span> = <a href="../Functoria/Context/index.html#type-t">Functoria.Context.t</a></span></code></div><div class="spec-doc"><p>The type for keys' parsing context. See <code>Key.context</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-value"><a href="#type-value" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a value</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Key/index.html#type-value">Functoria.Key.value</a></span></span></code></div><div class="spec-doc"><p>The type for values parsed from the command-line. See <a href="Key/index.html#type-value"><code>Key.value</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-key"><a href="#val-key" class="anchor"></a><code><span><span class="keyword">val</span> key : <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../Functoria/Key/index.html#type-t">Functoria.Key.t</a></span></code></div><div class="spec-doc"><p><code>key k</code> is an untyped representation of <code>k</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-if_impl"><a href="#val-if_impl" class="anchor"></a><code><span><span class="keyword">val</span> if_impl : <span><span>bool <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>if_impl v impl1 impl2</code> is <code>impl1</code> if <code>v</code> is resolved to true and <code>impl2</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-match_impl"><a href="#val-match_impl" class="anchor"></a><code><span><span class="keyword">val</span> match_impl : <span><span><span class="type-var">'b</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">default</span>:<span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span> * <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>match_impl v cases ~default</code> chooses the implementation amongst <code>cases</code> by matching the <code>v</code>'s value. <code>default</code> is chosen if no value matches.</p></div></div><h3 id="pkg"><a href="#pkg" class="anchor"></a>Package dependencies</h3><p>For specifying opam package dependencies, the type <a href="#type-package"><code>package</code></a> is used. It consists of the opam package name, the ocamlfind names, and optional lower and upper bounds. The version constraints are merged with other modules.</p><div class="odoc-spec"><div class="spec type anchored" id="type-package"><a href="#type-package" class="anchor"></a><code><span><span class="keyword">type</span> package</span><span> = <a href="../Functoria/Package/index.html#type-t">Functoria.Package.t</a></span></code></div><div class="spec-doc"><p>The type for opam packages.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-scope"><a href="#type-scope" class="anchor"></a><code><span><span class="keyword">type</span> scope</span><span> = <a href="../Functoria/Package/index.html#type-scope">Functoria.Package.scope</a></span></code></div><div class="spec-doc"><p>Installation scope of a package.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-package"><a href="#val-package" class="anchor"></a><code><span><span class="keyword">val</span> package : 
  <span><span class="optlabel">?scope</span>:<a href="#type-scope">scope</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?build</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sublibs</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?libs</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?min</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?max</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pin</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pin_version</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-package">package</a></span></code></div><div class="spec-doc"><p><code>package ~scope ~build ~sublibs ~libs ~min ~max ~pin opam</code> is a <code>package</code>. <code>Build</code> indicates a build-time dependency only, defaults to <code>false</code>. The library name is by default the same as <code>opam</code>, you can specify <code>~sublibs</code> to add additional sublibraries (e.g. <code>~sublibs:[&quot;mirage&quot;] &quot;foo&quot;</code> will result in the library names <code>[&quot;foo&quot;; &quot;foo.mirage&quot;]</code>. In case the library name is disjoint (or empty), use <code>~libs</code>. Specifying both <code>~libs</code> and <code>~sublibs</code> leads to an invalid argument. Version constraints are given as <code>min</code> (inclusive) and <code>max</code> (exclusive). If <code>pin</code> is provided, a <a href="https://opam.ocaml.org/doc/Manual.html#opamfield-pin-depends">pin-depends</a> is generated, <code>pin_version</code> is <code>&quot;dev&quot;</code> by default. <code>~scope</code> specifies the installation location of the package.</p></div></div><h3 id="app"><a href="#app" class="anchor"></a>Application Builder</h3><p>Values of type <a href="#type-impl"><code>impl</code></a> are tied to concrete module implementation with the <a href="#type-device"><code>device</code></a> and <a href="#val-main"><code>main</code></a> construct. Module implementations of type <a href="#type-job"><code>job</code></a> can then be <a href="../Functoria/Lib/Make/index.html#val-register" title="Functoria.Lib.Make.register">registered</a> into an application builder. The builder is in charge if parsing the command-line arguments and of generating code for the final application. See <a href="../Functoria/Lib/index.html"><code>Functoria.Lib</code></a> for details.</p><div class="odoc-spec"><div class="spec type anchored" id="type-info"><a href="#type-info" class="anchor"></a><code><span><span class="keyword">type</span> info</span><span> = <a href="../Functoria/Info/index.html#type-t">Functoria.Info.t</a></span></code></div><div class="spec-doc"><p>The type for build information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-main"><a href="#val-main" class="anchor"></a><code><span><span class="keyword">val</span> main : 
  <span><span class="optlabel">?pos</span>:<span>(string * int * int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages</span>:<span><a href="#type-package">package</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages_v</span>:<span><span><a href="#type-package">package</a> list</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runtime_args</span>:<span><a href="../Functoria/Runtime_arg/index.html#type-t">Functoria.Runtime_arg.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?deps</span>:<span><a href="#type-abstract_impl">abstract_impl</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>main name typ</code> is the functor <code>name</code>, having the module type <code>typ</code>. The connect code will call <code>&lt;name&gt;.start</code>.</p><ul><li>If <code>packages</code> or <code>packages_v</code> is set, then the given packages are installed before compiling the current application.</li></ul></div></div><h3 id="devices"><a href="#devices" class="anchor"></a>Devices</h3><div class="odoc-spec"><div class="spec type anchored" id="type-code"><a href="#type-code" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a code</span></span><span> = <span><span class="type-var">'a</span> <a href="../Functoria/Device/index.html#type-code">Functoria.Device.code</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-code"><a href="#val-code" class="anchor"></a><code><span><span class="keyword">val</span> code : 
  <span><span class="label">pos</span>:<span>(string * int * int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, <span><span class="type-var">'b</span> <a href="#type-code">code</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-device"><a href="#type-device" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a device</span></span><span> = <span><span>(<span class="type-var">'a</span>, <a href="#type-abstract_impl">abstract_impl</a>)</span> <a href="../Functoria/Device/index.html#type-t">Functoria.Device.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_device"><a href="#val-of_device" class="anchor"></a><code><span><span class="keyword">val</span> of_device : <span><span><span class="type-var">'a</span> <a href="#type-device">device</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>of_device t</code> is the implementation device <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-impl"><a href="#val-impl" class="anchor"></a><code><span><span class="keyword">val</span> impl : 
  <span><span class="optlabel">?packages</span>:<span><a href="#type-package">package</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages_v</span>:<span><span><a href="#type-package">package</a> list</span> <a href="../Functoria/Key/index.html#type-value">Functoria.Key.value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?install</span>:<span>(<span><a href="../Functoria/Info/index.html#type-t">Functoria.Info.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Functoria/Install/index.html#type-t">Functoria.Install.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?install_v</span>:<span>(<span><a href="../Functoria/Info/index.html#type-t">Functoria.Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Functoria/Install/index.html#type-t">Functoria.Install.t</a> <a href="../Functoria/Key/index.html#type-value">Functoria.Key.value</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?keys</span>:<span><a href="../Functoria/Key/index.html#type-t">Functoria.Key.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runtime_args</span>:<span><a href="../Functoria/Runtime_arg/index.html#type-t">Functoria.Runtime_arg.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?extra_deps</span>:<span><a href="#type-abstract_impl">abstract_impl</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connect</span>:<span>(<span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-code">code</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dune</span>:<span>(<span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Functoria/Dune/index.html#type-stanza">Functoria.Dune.stanza</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?configure</span>:<span>(<span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../Functoria/Action/index.html#type-t">Functoria.Action.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?files</span>:<span>(<span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Fpath</span>.t list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>impl ~packages ~packages_v ~install ~install_v ~keys ~runtime_args
     ~extra_deps ~connect ~dune ~configure ~files module_name module_type</code> is an implementation of the device constructed by the arguments. <code>packages</code> and <code>packages_v</code> are the dependencies (where <code>packages_v</code> is inside <a href="Key/index.html#type-value"><code>Key.value</code></a>). <code>install</code> and <code>install_v</code> are the install instructions (used in the generated opam file), <code>keys</code> are the configuration-time keys, <code>runtime_args</code> the arguments at runtime, <code>extra_deps</code> are a list of extra dependencies (other implementations), <code>connect</code> is the code emitted for initializing the device, <code>dune</code> are dune stanzas added to the build rule, <code>configure</code> are commands executed at the configuration phase, <code>files</code> are files to be added to the list of generated files, <code>module_name</code> is the name of the device module, and <code>module_type</code> is the type of the module.</p></div></div><h3 id="jobs"><a href="#jobs" class="anchor"></a>Jobs</h3><div class="odoc-spec"><div class="spec type anchored" id="type-job"><a href="#type-job" class="anchor"></a><code><span><span class="keyword">type</span> job</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Key"><a href="#module-Key" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Key/index.html">Key</a></span><span> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="../Devices/Key/index.html">Devices.Key</a> <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Configuration keys.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Runtime_arg"><a href="#module-Runtime_arg" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Runtime_arg/index.html">Runtime_arg</a></span><span> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="../Devices/Runtime_arg/index.html">Devices.Runtime_arg</a> <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Configuration keys.</p></div></div><h3 id="general-mirage-devices"><a href="#general-mirage-devices" class="anchor"></a>General mirage devices</h3><div class="odoc-spec"><div class="spec type anchored" id="type-qubesdb"><a href="#type-qubesdb" class="anchor"></a><code><span><span class="keyword">type</span> qubesdb</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-qubesdb"><a href="#val-qubesdb" class="anchor"></a><code><span><span class="keyword">val</span> qubesdb : <span><a href="#type-qubesdb">qubesdb</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>For the Qubes target, the Qubes database from which to look up dynamic runtime configuration information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_qubesdb"><a href="#val-default_qubesdb" class="anchor"></a><code><span><span class="keyword">val</span> default_qubesdb : <span><a href="#type-qubesdb">qubesdb</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>A default qubes database, guessed from the usual valid configurations.</p></div></div><h3 id="sleep"><a href="#sleep" class="anchor"></a>Sleep</h3><div class="odoc-spec"><div class="spec type anchored" id="type-sleep"><a href="#type-sleep" class="anchor"></a><code><span><span class="keyword">type</span> sleep</span></code></div><div class="spec-doc"><p>Abstract type for sleep.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sleep"><a href="#val-sleep" class="anchor"></a><code><span><span class="keyword">val</span> sleep : <span><a href="#type-sleep">sleep</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_sleep</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_sleep"><a href="#val-default_sleep" class="anchor"></a><code><span><span class="keyword">val</span> default_sleep : <span><a href="#type-sleep">sleep</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>The default sleep implementation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_sleep"><a href="#val-no_sleep" class="anchor"></a><code><span><span class="keyword">val</span> no_sleep : <span><a href="#type-sleep">sleep</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Disables the sleep implementation.</p></div></div><h3 id="posix-time"><a href="#posix-time" class="anchor"></a>Posix time</h3><div class="odoc-spec"><div class="spec type anchored" id="type-ptime"><a href="#type-ptime" class="anchor"></a><code><span><span class="keyword">type</span> ptime</span></code></div><div class="spec-doc"><p>Abstract type for POSIX time.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ptime"><a href="#val-ptime" class="anchor"></a><code><span><span class="keyword">val</span> ptime : <span><a href="#type-ptime">ptime</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_ptime</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_ptime"><a href="#val-default_ptime" class="anchor"></a><code><span><span class="keyword">val</span> default_ptime : <span><a href="#type-ptime">ptime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>The default mirage-ptime implementation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_ptime"><a href="#val-no_ptime" class="anchor"></a><code><span><span class="keyword">val</span> no_ptime : <span><a href="#type-ptime">ptime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Disables the mirage-ptime implementation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mock_ptime"><a href="#val-mock_ptime" class="anchor"></a><code><span><span class="keyword">val</span> mock_ptime : <span><a href="#type-ptime">ptime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>A ptime mock implementation where you can manually set the clock via <code>Mirage_ptime_set</code>.</p></div></div><h3 id="monotonic-time"><a href="#monotonic-time" class="anchor"></a>Monotonic time</h3><div class="odoc-spec"><div class="spec type anchored" id="type-mtime"><a href="#type-mtime" class="anchor"></a><code><span><span class="keyword">type</span> mtime</span></code></div><div class="spec-doc"><p>Abstract type for monotonic time</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtime"><a href="#val-mtime" class="anchor"></a><code><span><span class="keyword">val</span> mtime : <span><a href="#type-mtime">mtime</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_mtime</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_mtime"><a href="#val-default_mtime" class="anchor"></a><code><span><span class="keyword">val</span> default_mtime : <span><a href="#type-mtime">mtime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>The default mirage-mtime implementation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_mtime"><a href="#val-no_mtime" class="anchor"></a><code><span><span class="keyword">val</span> no_mtime : <span><a href="#type-mtime">mtime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Disables the mirage-mtime implementation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mock_mtime"><a href="#val-mock_mtime" class="anchor"></a><code><span><span class="keyword">val</span> mock_mtime : <span><a href="#type-mtime">mtime</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>A mtime mock implementation where you can manually set the clock via <code>Mirage_mtime_set</code>.</p></div></div><h3 id="log-reporters"><a href="#log-reporters" class="anchor"></a>Log reporters</h3><div class="odoc-spec"><div class="spec type anchored" id="type-reporter"><a href="#type-reporter" class="anchor"></a><code><span><span class="keyword">type</span> reporter</span></code></div><div class="spec-doc"><p>The type for log reporters.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reporter"><a href="#val-reporter" class="anchor"></a><code><span><span class="keyword">val</span> reporter : <span><a href="#type-reporter">reporter</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the log <a href="#type-reporter"><code>reporter</code></a> type.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_reporter"><a href="#val-default_reporter" class="anchor"></a><code><span><span class="keyword">val</span> default_reporter : <span><span class="optlabel">?level</span>:<span><span class="xref-unresolved">Logs</span>.level option</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-reporter">reporter</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>default_reporter ?level ()</code> is the log reporter that prints log messages to the console, with a timestamp as prefix. <code>level</code> is the default log threshold. It is <code>Some Logs.Info</code> if not specified.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_reporter"><a href="#val-no_reporter" class="anchor"></a><code><span><span class="keyword">val</span> no_reporter : <span><a href="#type-reporter">reporter</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>no_reporter</code> disable log reporting.</p></div></div><h3 id="random"><a href="#random" class="anchor"></a>Random</h3><div class="odoc-spec"><div class="spec type anchored" id="type-random"><a href="#type-random" class="anchor"></a><code><span><span class="keyword">type</span> random</span></code></div><div class="spec-doc"><p>Abstract type for random sources.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-random"><a href="#val-random" class="anchor"></a><code><span><span class="keyword">val</span> random : <span><a href="#type-random">random</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_crypto_rng_mirage2</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_random"><a href="#val-default_random" class="anchor"></a><code><span><span class="keyword">val</span> default_random : <span><a href="#type-random">random</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Default PRNG device to be used in unikernels. It uses getrandom/getentropy on Unix, and a Fortuna PRNG on other targets.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_random"><a href="#val-no_random" class="anchor"></a><code><span><span class="keyword">val</span> no_random : <span><a href="#type-random">random</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Disables the random device.</p></div></div><h3 id="block-devices"><a href="#block-devices" class="anchor"></a>Block devices</h3><div class="odoc-spec"><div class="spec type anchored" id="type-block"><a href="#type-block" class="anchor"></a><code><span><span class="keyword">type</span> block</span></code></div><div class="spec-doc"><p>Abstract type for raw block device configurations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block"><a href="#val-block" class="anchor"></a><code><span><span class="keyword">val</span> block : <span><a href="#type-block">block</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_block.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block_of_file"><a href="#val-block_of_file" class="anchor"></a><code><span><span class="keyword">val</span> block_of_file : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use the given file as a raw block device.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block_of_xenstore_id"><a href="#val-block_of_xenstore_id" class="anchor"></a><code><span><span class="keyword">val</span> block_of_xenstore_id : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use the given XenStore ID (ex: <code>/dev/xvdi1</code> or <code>51760</code>) as a raw block device.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ramdisk"><a href="#val-ramdisk" class="anchor"></a><code><span><span class="keyword">val</span> ramdisk : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use a ramdisk with the given name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generic_block"><a href="#val-generic_block" class="anchor"></a><code><span><span class="keyword">val</span> generic_block : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?key</span>:<span><span>[ `XenstoreId <span>| `BlockFile</span> <span>| `Ramdisk</span> ]</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="static-key/value-stores"><a href="#static-key/value-stores" class="anchor"></a>Static key/value stores</h3><div class="odoc-spec"><div class="spec type anchored" id="type-kv_ro"><a href="#type-kv_ro" class="anchor"></a><code><span><span class="keyword">type</span> kv_ro</span></code></div><div class="spec-doc"><p>Abstract type for read-only key/value store.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kv_ro"><a href="#val-kv_ro" class="anchor"></a><code><span><span class="keyword">val</span> kv_ro : <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_kv.RO</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-crunch"><a href="#val-crunch" class="anchor"></a><code><span><span class="keyword">val</span> crunch : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Crunch a directory. The contents of the directory is transformed into OCaml code, which is then compiled as part of the unikernel.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tar_kv_ro"><a href="#val-tar_kv_ro" class="anchor"></a><code><span><span class="keyword">val</span> tar_kv_ro : <span><span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>tar_kv_ro block</code> is a read-only tar archive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-direct_kv_ro"><a href="#val-direct_kv_ro" class="anchor"></a><code><span><span class="keyword">val</span> direct_kv_ro : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Direct access to the underlying filesystem as a key/value store for Unix. For other backends, this is equivalent to <code>crunch</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fat_ro"><a href="#val-fat_ro" class="anchor"></a><code><span><span class="keyword">val</span> fat_ro : <span><span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use a FAT formatted block device.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generic_kv_ro"><a href="#val-generic_kv_ro" class="anchor"></a><code><span><span class="keyword">val</span> generic_kv_ro : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?key</span>:<span><span>[ `Crunch <span>| `Direct</span> ]</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Generic key/value that will choose dynamically between <a href="#val-direct_kv_ro"><code>direct_kv_ro</code></a> and <a href="#val-crunch"><code>crunch</code></a>. To use a filesystem implementation, try <code>kv_ro_of_fs</code>.</p><p>If no key is provided, a new <a href="Key/index.html#val-kv_ro"><code>Key.kv_ro</code></a> is created with the <code>group</code> argument.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-docteur"><a href="#val-docteur" class="anchor"></a><code><span><span class="keyword">val</span> docteur : 
  <span><span class="optlabel">?mode</span>:<span>[ `Fast <span>| `Light</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?name</span>:<span>string <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?output</span>:<span>string <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?analyze</span>:<span>bool <a href="#type-runtime_arg">runtime_arg</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?branch</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?extra_deps</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>docteur ?mode ?name ?output ?analyze remote</code> is a read-only, key-value store device. Data is stored on that device using the Git PACK file format, version 2. This format has very good compression factors for many similar files of relatively small size. For instance, 14Gb of HTML files can be compressed into a disk image of 240Mb.</p><p>Unlike <a href="#val-crunch"><code>crunch</code></a>, <code>docteur</code> produces an external image which means that less memory is used to keep and get files. The image can be produced from many sources:</p><ul><li>A local Git repository (like <code>file://path/to/the/git/repository/</code>)</li><li>A simple directory (like <code>file://path/to/a/simple/directory/</code>)</li><li>A remote Git repository (via SSH, HTTP(S) or TCP/IP as what <code>git clone</code> expects)</li></ul><p>If you use a Git repository, you can choose a specific branch with the <code>?branch</code> argument (like <code>refs/heads/main</code>). Otherwise, this argument is ignored.</p><p>If you use a simple directory, it can be a relative from your unikernel project (<code>relativize://directory</code>) or an absolute path (<code>file://home/user/directory</code>).</p><p>If a required file is produced by a <code>dune</code> rule, you must notice it via the <code>extra_deps</code> argument.</p><p>For a Solo5 target, users must <i>attach</i> the image as a block device:</p><pre class="language-ocaml"><code>$ solo5-hvt --block:&lt;name&gt;=&lt;path-to-the-image&gt; -- unikernel.{hvt,...}</code></pre><p>The user is able to specify the name of the block device (default to <code>&quot;docteur&quot;</code>). The user can also specify the output of <code>docteur.make</code>, the tool which generate the image (default to <code>&quot;disk.img&quot;</code>).</p><p>For the Unix target, the program <code>open</code> the image at the beginning of the process. An integrity check of the image can be done via the <code>analyze</code> value (defaults to <code>true</code>).</p><p>It's possible to use the file-system into 2 modes:</p><ul><li><code>`Light</code>: any access requires that we reconstruct the path to the requested file. That means that we will need to extract a few additional objects before the extraction of the requested one. <code>`Light</code> does not cache anything in memory but it can be slower if the requested file is deep in the directory structure.</li><li><code>`Fast</code>: reconstructs and cache the layout of the directory structure when the unikernel starts: it might increase boot-time and bigger memory requirements. However, <code>`Fast</code> allows the device to decode only the requested object so it is faster than the <code>`Light</code> mode.</li></ul></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-kv_rw"><a href="#type-kv_rw" class="anchor"></a><code><span><span class="keyword">type</span> kv_rw</span></code></div><div class="spec-doc"><p>Abstract type for read-write key/value store.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kv_rw"><a href="#val-kv_rw" class="anchor"></a><code><span><span class="keyword">val</span> kv_rw : <span><a href="#type-kv_rw">kv_rw</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_kv.RW</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-direct_kv_rw"><a href="#val-direct_kv_rw" class="anchor"></a><code><span><span class="keyword">val</span> direct_kv_rw : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_rw">kv_rw</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Direct access to the underlying filesystem as a key/value store. Only available on Unix backends.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kv_rw_mem"><a href="#val-kv_rw_mem" class="anchor"></a><code><span><span class="keyword">val</span> kv_rw_mem : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_rw">kv_rw</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>An in-memory key-value store using <code>mirage-kv-mem</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-chamelon"><a href="#val-chamelon" class="anchor"></a><code><span><span class="keyword">val</span> chamelon : <span><span class="label">program_block_size</span>:<span>int <a href="#type-runtime_arg">runtime_arg</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_rw">kv_rw</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>chamelon ~program_block_size</code> returns a <a href="#val-kv_rw"><code>kv_rw</code></a> filesystem which is an implementation of <a href="https://github.com/littlefs-project/littlefs">littlefs</a> in OCaml. The <code>chamelon</code> device expects a <i>block-device</i>.</p><p><code>unikernel.ml</code>:</p><pre class="language-ocaml"><code>open Cmdliner

let program_block_size =
  Arg.(value &amp; opt int 16 &amp; info [ &quot;program-block-size&quot; ])</code></pre><p><code>config.ml</code>:</p><pre class="language-ocaml"><code>let db =
  let program_block_size =
    Runtime_arg.create ~pos:__POS__ &quot;Unikernel.program_block_size&quot;
  in
  let block = block_of_file &quot;db&quot; in
  chamelon ~program_block_size block
in</code></pre><p>For Solo5 targets, you finally can launch the unikernel with:</p><pre class="language-ocaml"><code>$ solo5-hvt --block:db=db.img unikernel.hvt</code></pre><p>The block-device must be well-formed and <i>formatted</i> by the <code>chamelon</code> tool:</p><pre class="language-ocaml"><code>$ dd if=/dev/zero of=db.img bs=1M count=1
$ chamelon format db.img 512</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tar_kv_rw"><a href="#val-tar_kv_rw" class="anchor"></a><code><span><span class="keyword">val</span> tar_kv_rw : <span><span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-kv_rw">kv_rw</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>tar_kv_rw block</code> is a read/write tar archive. Note that the filesystem is append-only. That is, files can generally not be removed, <code>set_partial</code> only works on what is allocated, and there are restrictions on <code>rename</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ccm_block"><a href="#val-ccm_block" class="anchor"></a><code><span><span class="keyword">val</span> ccm_block : 
  <span><span class="optlabel">?nonce_len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>string option</span> <a href="#type-runtime_arg">runtime_arg</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>ccm_block key block</code> returns a new block which is a AES-CCM encrypted disk.</p><p><b>Note</b> also that the available size of an encrypted block is always divided by 2 of its real size: a 512M block will only be able to contain 256M data if it is encrypted.</p><p>You can either use a fresh block device as encrypted storage. This does not need any preparation, just using <code>ccm_block</code> with the desired <code>key</code>. If you have an existing disk image that you want to encrypt, you can use the <code>ccmblock</code> tool given by the <code>mirage-block-ccm</code> opam package.</p><pre class="language-ocaml"><code>$ ccmblock enc -i db.img -k 0x10786d3a9c920d0b3ec80dfaaac557a7 -o edb.img</code></pre><p>Accept the key as a runtime argument, in <code>unikernel.ml</code>:</p><pre class="language-ocaml"><code>open Cmdliner

let aes_ccm_key =
  let doc = &quot;The key of the block device (hex formatted)&quot; in
  Arg.(required &amp; opt (some string) None &amp; info ~doc [ &quot;aes-ccm-key&quot; ])</code></pre><p>Then, into you <code>config.ml</code>, you just need to compose your block device with <code>ccm_block</code>:</p><pre class="language-ocaml"><code>let encrypted_block =
  let aes_ccm_key =
    Runtime_arg.create ~pos:__POS__ &quot;Unikernel.aes_ccm_key&quot;
  in
  let block = block_of_file &quot;edb&quot;
  ccm_block aes_ccm_key block
in</code></pre><p>Finally, with Solo5, you can launch your unikernel with that:</p><pre class="language-ocaml"><code>$ solo5-hvt --block:edb=edb.img \
  --arg=&quot;--aes-ccm-key=0x10786d3a9c920d0b3ec80dfaaac557a7&quot; \
  unikernel.hvt</code></pre><p>You can finally compose a file-system such as <a href="#val-chamelon"><code>chamelon</code></a> with this block device (and you have a encrypted file-system!):</p><pre class="language-ocaml"><code>let fs = chamelon ~program_block_size encrypted_block</code></pre></div></div><h3 id="network-interfaces"><a href="#network-interfaces" class="anchor"></a>Network interfaces</h3><div class="odoc-spec"><div class="spec type anchored" id="type-network"><a href="#type-network" class="anchor"></a><code><span><span class="keyword">type</span> network</span></code></div><div class="spec-doc"><p>Abstract type for network configurations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-network"><a href="#val-network" class="anchor"></a><code><span><span class="keyword">val</span> network : <span><a href="#type-network">network</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Mirage_net.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_network"><a href="#val-default_network" class="anchor"></a><code><span><span class="keyword">val</span> default_network : <span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>default_network</code> is a dynamic network implementation which attempts to do something reasonable based on the target.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-netif"><a href="#val-netif" class="anchor"></a><code><span><span class="keyword">val</span> netif : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>A custom network interface. Exposes a <a href="Runtime_arg/index.html#val-interface"><code>Runtime_arg.interface</code></a> key.</p></div></div><h3 id="ethernet-configuration"><a href="#ethernet-configuration" class="anchor"></a>Ethernet configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-ethernet"><a href="#type-ethernet" class="anchor"></a><code><span><span class="keyword">type</span> ethernet</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ethernet"><a href="#val-ethernet" class="anchor"></a><code><span><span class="keyword">val</span> ethernet : <span><a href="#type-ethernet">ethernet</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementations of the <code>Ethernet.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-etif"><a href="#val-etif" class="anchor"></a><code><span><span class="keyword">val</span> etif : <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>etif net</code> is the ethernet layer on <code>net</code>.</p><ul class="at-tags"><li class="deprecated"><span class="at-tag">deprecated</span> Deprecated. Use [ethif] instead.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ethif"><a href="#val-ethif" class="anchor"></a><code><span><span class="keyword">val</span> ethif : <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>ethif net</code> is the ethernet layer on <code>net</code>.</p></div></div><h3 id="arp-configuration"><a href="#arp-configuration" class="anchor"></a>ARP configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-arpv4"><a href="#type-arpv4" class="anchor"></a><code><span><span class="keyword">type</span> arpv4</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-arpv4"><a href="#val-arpv4" class="anchor"></a><code><span><span class="keyword">val</span> arpv4 : <span><a href="#type-arpv4">arpv4</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the <code>Arp.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-arp"><a href="#val-arp" class="anchor"></a><code><span><span class="keyword">val</span> arp : <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>ARP implementation provided by the arp library</p></div></div><h3 id="ip-configuration"><a href="#ip-configuration" class="anchor"></a>IP configuration</h3><p>Implementations of the <code>Tcpip.Ip.S</code> signature.</p><div class="odoc-spec"><div class="spec type anchored" id="type-v4"><a href="#type-v4" class="anchor"></a><code><span><span class="keyword">type</span> v4</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-v6"><a href="#type-v6" class="anchor"></a><code><span><span class="keyword">type</span> v6</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-v4v6"><a href="#type-v4v6" class="anchor"></a><code><span><span class="keyword">type</span> v4v6</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ip"><a href="#type-ip" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a ip</span></span></code></div><div class="spec-doc"><p>Abstract type for IP configurations.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ipv4"><a href="#type-ipv4" class="anchor"></a><code><span><span class="keyword">type</span> ipv4</span><span> = <span><a href="#type-v4">v4</a> <a href="#type-ip">ip</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ipv6"><a href="#type-ipv6" class="anchor"></a><code><span><span class="keyword">type</span> ipv6</span><span> = <span><a href="#type-v6">v6</a> <a href="#type-ip">ip</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ipv4v6"><a href="#type-ipv4v6" class="anchor"></a><code><span><span class="keyword">type</span> ipv4v6</span><span> = <span><a href="#type-v4v6">v4v6</a> <a href="#type-ip">ip</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ipv4"><a href="#val-ipv4" class="anchor"></a><code><span><span class="keyword">val</span> ipv4 : <span><a href="#type-ipv4">ipv4</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>The <code>Tcpip.Ip.S</code> module signature with ipaddr = Ipaddr.V4.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ipv6"><a href="#val-ipv6" class="anchor"></a><code><span><span class="keyword">val</span> ipv6 : <span><a href="#type-ipv6">ipv6</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>The <code>Tcpip.Ip.S</code> module signature with ipaddr = Ipaddr.V6.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ipv4v6"><a href="#val-ipv4v6" class="anchor"></a><code><span><span class="keyword">val</span> ipv4v6 : <span><a href="#type-ipv4v6">ipv4v6</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>The <code>Tcpip.Ip.S</code> module signature with ipaddr = Ipaddr.t.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ipv4_config"><a href="#type-ipv4_config" class="anchor"></a><code><span><span class="keyword">type</span> ipv4_config</span><span> = </span><span>{</span></code><ol><li id="type-ipv4_config.network" class="def record field anchored"><a href="#type-ipv4_config.network" class="anchor"></a><code><span>network : <span class="xref-unresolved">Ipaddr</span>.V4.Prefix.t;</span></code></li><li id="type-ipv4_config.gateway" class="def record field anchored"><a href="#type-ipv4_config.gateway" class="anchor"></a><code><span>gateway : <span><span class="xref-unresolved">Ipaddr</span>.V4.t option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Types for manual IPv4 configuration.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ipv6_config"><a href="#type-ipv6_config" class="anchor"></a><code><span><span class="keyword">type</span> ipv6_config</span><span> = </span><span>{</span></code><ol><li id="type-ipv6_config.network" class="def record field anchored"><a href="#type-ipv6_config.network" class="anchor"></a><code><span>network : <span class="xref-unresolved">Ipaddr</span>.V6.Prefix.t;</span></code></li><li id="type-ipv6_config.gateway" class="def record field anchored"><a href="#type-ipv6_config.gateway" class="anchor"></a><code><span>gateway : <span><span class="xref-unresolved">Ipaddr</span>.V6.t option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Types for manual IPv6 configuration.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ipv4_of_dhcp"><a href="#val-ipv4_of_dhcp" class="anchor"></a><code><span><span class="keyword">val</span> ipv4_of_dhcp : <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ipv4">ipv4</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Configure the interface via DHCP</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_ipv4"><a href="#val-create_ipv4" class="anchor"></a><code><span><span class="keyword">val</span> create_ipv4 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?config</span>:<a href="#type-ipv4_config">ipv4_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-ipv4">ipv4</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use an IPv4 address Exposes the keys <a href="../Devices/Runtime_arg/V4/index.html#val-network"><code>Runtime_arg.V4.network</code></a> and <a href="../Devices/Runtime_arg/V4/index.html#val-gateway"><code>Runtime_arg.V4.gateway</code></a>. If provided, the values of these keys will override those supplied in the ipv4 configuration record, if that has been provided.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ipv4_qubes"><a href="#val-ipv4_qubes" class="anchor"></a><code><span><span class="keyword">val</span> ipv4_qubes : <span><span><a href="#type-qubesdb">qubesdb</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ipv4">ipv4</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use a given initialized QubesDB to look up and configure the appropriate * IPv4 interface.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_ipv6"><a href="#val-create_ipv6" class="anchor"></a><code><span><span class="keyword">val</span> create_ipv6 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?config</span>:<a href="#type-ipv6_config">ipv6_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-ipv6">ipv6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Use an IPv6 address. Exposes the keys <a href="../Devices/Runtime_arg/V6/index.html#val-network"><code>Runtime_arg.V6.network</code></a>, <a href="../Devices/Runtime_arg/V6/index.html#val-gateway"><code>Runtime_arg.V6.gateway</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_ipv4v6"><a href="#val-create_ipv4v6" class="anchor"></a><code><span><span class="keyword">val</span> create_ipv4v6 : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-ipv4">ipv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-ipv6">ipv6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ipv4v6">ipv4v6</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="udp-configuration"><a href="#udp-configuration" class="anchor"></a>UDP configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-udp"><a href="#type-udp" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a udp</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-udpv4v6"><a href="#type-udpv4v6" class="anchor"></a><code><span><span class="keyword">type</span> udpv4v6</span><span> = <span><a href="#type-v4v6">v4v6</a> <a href="#type-udp">udp</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-udp"><a href="#val-udp" class="anchor"></a><code><span><span class="keyword">val</span> udp : <span><span><span class="type-var">'a</span> <a href="#type-udp">udp</a></span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the <code>Tcpip.Udp.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-udpv4v6"><a href="#val-udpv4v6" class="anchor"></a><code><span><span class="keyword">val</span> udpv4v6 : <span><a href="#type-udpv4v6">udpv4v6</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-direct_udp"><a href="#val-direct_udp" class="anchor"></a><code><span><span class="keyword">val</span> direct_udp : <span><span><span><span class="type-var">'a</span> <a href="#type-ip">ip</a></span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-udp">udp</a></span> <a href="#type-impl">impl</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-socket_udpv4v6"><a href="#val-socket_udpv4v6" class="anchor"></a><code><span><span class="keyword">val</span> socket_udpv4v6 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Ipaddr</span>.V4.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Ipaddr</span>.V6.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-udpv4v6">udpv4v6</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="tcp-configuration"><a href="#tcp-configuration" class="anchor"></a>TCP configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-tcp"><a href="#type-tcp" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a tcp</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tcpv4v6"><a href="#type-tcpv4v6" class="anchor"></a><code><span><span class="keyword">type</span> tcpv4v6</span><span> = <span><a href="#type-v4v6">v4v6</a> <a href="#type-tcp">tcp</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tcp"><a href="#val-tcp" class="anchor"></a><code><span><span class="keyword">val</span> tcp : <span><span><span class="type-var">'a</span> <a href="#type-tcp">tcp</a></span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the <code>Tcpip.Tcp.S</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tcpv4v6"><a href="#val-tcpv4v6" class="anchor"></a><code><span><span class="keyword">val</span> tcpv4v6 : <span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-direct_tcp"><a href="#val-direct_tcp" class="anchor"></a><code><span><span class="keyword">val</span> direct_tcp : <span><span><span><span class="type-var">'a</span> <a href="#type-ip">ip</a></span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-tcp">tcp</a></span> <a href="#type-impl">impl</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-socket_tcpv4v6"><a href="#val-socket_tcpv4v6" class="anchor"></a><code><span><span class="keyword">val</span> socket_tcpv4v6 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Ipaddr</span>.V4.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Ipaddr</span>.V6.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="network-stack-configuration"><a href="#network-stack-configuration" class="anchor"></a>Network stack configuration</h3><h4 id="dual-ipv4-and-ipv6"><a href="#dual-ipv4-and-ipv6" class="anchor"></a>Dual IPv4 and IPv6</h4><div class="odoc-spec"><div class="spec type anchored" id="type-stackv4v6"><a href="#type-stackv4v6" class="anchor"></a><code><span><span class="keyword">type</span> stackv4v6</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stackv4v6"><a href="#val-stackv4v6" class="anchor"></a><code><span><span class="keyword">val</span> stackv4v6 : <span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the <code>Tcpip.Stack.V4V6</code> signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-direct_stackv4v6"><a href="#val-direct_stackv4v6" class="anchor"></a><code><span><span class="keyword">val</span> direct_stackv4v6 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?tcp</span>:<span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-ipv4">ipv4</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-ipv6">ipv6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Direct network stack with given ip.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-socket_stackv4v6"><a href="#val-socket_stackv4v6" class="anchor"></a><code><span><span class="keyword">val</span> socket_stackv4v6 : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Network stack with sockets.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-static_ipv4v6_stack"><a href="#val-static_ipv4v6_stack" class="anchor"></a><code><span><span class="keyword">val</span> static_ipv4v6_stack : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ipv6_config</span>:<a href="#type-ipv6_config">ipv6_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ipv4_config</span>:<a href="#type-ipv4_config">ipv4_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?arp</span>:<span>(<span><span><a href="#type-ethernet">ethernet</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-arpv4">arpv4</a> <a href="#type-impl">impl</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?tcp</span>:<span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Build a stackv4v6 by checking the <a href="../Devices/Runtime_arg/V6/index.html#val-network"><code>Runtime_arg.V6.network</code></a>, and <a href="../Devices/Runtime_arg/V6/index.html#val-gateway"><code>Runtime_arg.V6.gateway</code></a> keys for IPv4 and IPv6 configuration information, filling in unspecified information from <code>?config</code>, then building a stack on top of that.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generic_stackv4v6"><a href="#val-generic_stackv4v6" class="anchor"></a><code><span><span class="keyword">val</span> generic_stackv4v6 : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ipv6_config</span>:<a href="#type-ipv6_config">ipv6_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ipv4_config</span>:<a href="#type-ipv4_config">ipv4_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dhcp_key</span>:<span>bool <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?net_key</span>:<span><span><span>[ `OCaml <span>| `Host</span> ]</span> option</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?tcp</span>:<span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-network">network</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Generic stack using a <code>net</code> keys: <a href="Key/index.html#val-net"><code>Key.net</code></a>.</p><ul><li>If <code>net</code> = <code>host</code> then <a href="#val-socket_stackv4v6"><code>socket_stackv4v6</code></a> is used</li><li>Else, if <code>unix or macosx</code> then <a href="#val-socket_stackv4v6"><code>socket_stackv4v6</code></a> is used</li><li>Else, <a href="#val-static_ipv4v6_stack"><code>static_ipv4v6_stack</code></a> is used.</li></ul><p>If a key is not provided, it uses <a href="Key/index.html#val-net"><code>Key.net</code></a> (with the <code>group</code> argument) to create it.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tcpv4v6_of_stackv4v6"><a href="#val-tcpv4v6_of_stackv4v6" class="anchor"></a><code><span><span class="keyword">val</span> tcpv4v6_of_stackv4v6 : <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>tcpv4v6 stackv4v6</code> is an helper to extract the TCP/IP stack regardless the UDP/IP stack expected by some <i>devices</i> such as protocols.</p></div></div><h3 id="resolver-configuration"><a href="#resolver-configuration" class="anchor"></a>Resolver configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-resolver"><a href="#type-resolver" class="anchor"></a><code><span><span class="keyword">type</span> resolver</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resolver"><a href="#val-resolver" class="anchor"></a><code><span><span class="keyword">val</span> resolver : <span><a href="#type-resolver">resolver</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resolver_dns"><a href="#val-resolver_dns" class="anchor"></a><code><span><span class="keyword">val</span> resolver_dns : <span><span class="optlabel">?ns</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-resolver">resolver</a> <a href="#type-impl">impl</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resolver_unix_system"><a href="#val-resolver_unix_system" class="anchor"></a><code><span><span class="keyword">val</span> resolver_unix_system : <span><a href="#type-resolver">resolver</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="happy-eyeballs"><a href="#happy-eyeballs" class="anchor"></a>Happy-eyeballs</h3><p>Happy-eyeballs is an implementation of RFC 8305 which specifies how to connect to a remote host using either IP protocol version 4 or IP protocol version 6 from a <code>stackv4v6</code> network implementation.</p><p>The given <i>device</i> is able to resolve a remote host <i>via</i> a <a href="#val-dns_client"><code>dns_client</code></a> device and both must share the same <code>stackv4v6</code> implementation.</p><div class="odoc-spec"><div class="spec type anchored" id="type-happy_eyeballs"><a href="#type-happy_eyeballs" class="anchor"></a><code><span><span class="keyword">type</span> happy_eyeballs</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-happy_eyeballs"><a href="#val-happy_eyeballs" class="anchor"></a><code><span><span class="keyword">val</span> happy_eyeballs : <span><a href="#type-happy_eyeballs">happy_eyeballs</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generic_happy_eyeballs"><a href="#val-generic_happy_eyeballs" class="anchor"></a><code><span><span class="keyword">val</span> generic_happy_eyeballs : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?aaaa_timeout</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connect_delay</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connect_timeout</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?resolve_timeout</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?resolve_retries</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timer_interval</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-happy_eyeballs">happy_eyeballs</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>generic_happy_eyeballs stackv4v6</code> creates a new happy-eyeballs value which is able to connect to a remote host and allocate finally a connected <i>flow</i> from the given network implementation <code>stackv4v6</code>. However, if you want to resolve (DNS resolution) &amp; connect to a remote host, you must complete your unikernel with a <a href="#val-generic_dns_client"><code>generic_dns_client</code></a> which upgrade the happy-eyeballs stack with a DNS resolution stack.</p><p>This device has several optional arguments of keys for timeouts specified in nanoseconds.</p></div></div><h3 id="dns-client"><a href="#dns-client" class="anchor"></a>DNS client</h3><p>A DNS client is a module which implements:</p><ul><li><code>getaddrinfo</code> to request a <code>query_type</code>-dependent response to a nameserver regarding a domain-name such as the <code>MX</code> record.</li><li><code>gethostbyname</code> to request the <code>A</code> regarding a domain-name</li><li><code>gethostbyname6</code> to request the <code>AAAA</code> record regarding a domain-name</li></ul><div class="odoc-spec"><div class="spec type anchored" id="type-dns_client"><a href="#type-dns_client" class="anchor"></a><code><span><span class="keyword">type</span> dns_client</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dns_client"><a href="#val-dns_client" class="anchor"></a><code><span><span class="keyword">val</span> dns_client : <span><a href="#type-dns_client">dns_client</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generic_dns_client"><a href="#val-generic_dns_client" class="anchor"></a><code><span><span class="keyword">val</span> generic_dns_client : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:int64 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?nameservers</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?cache_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-happy_eyeballs">happy_eyeballs</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-dns_client">dns_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>generic_dns_client stackv4v6 happy_eyeballs</code> creates a new DNS value which is able to resolve domain-name from <code>nameservers</code>. It requires a network and happy-eyeballs stack to communicate with these nameservers.</p><p>The <code>nameservers</code> argument is a list of strings. The format of them is:</p><ul><li><code>udp:ipaddr(:port)?</code> if you want to communicate with a DNS resolver <i>via</i> UDP</li><li><code>tcp:ipaddr(:port)?</code> if you want to communicate with a DNS resolver <i>via</i> TCP/IP</li><li><code>tls:ipaddr(:port)?(!&lt;authenticator&gt;)</code> if you to communicate with a DNS resolver <i>via</i> TLS. You are able to introduce an <code>&lt;authenticator&gt;</code> (please, follow the documentation about <code>X509.Authenticator.of_string</code> to get an explanation of its format). Otherwise, by default, we use trust anchors from NSS' <code>certdata.txt</code>.</li></ul></div></div><h3 id="syslog-configuration"><a href="#syslog-configuration" class="anchor"></a>Syslog configuration</h3><p>Syslog exfiltrates log messages (generated by libraries using the <code>logs</code> library) via a network connection. The log level of the log sources is controlled via the <code>Mirage_runtime.logs</code> key. The functionality is provided by the <code>logs-syslog</code> package.</p><div class="odoc-spec"><div class="spec type anchored" id="type-syslog"><a href="#type-syslog" class="anchor"></a><code><span><span class="keyword">type</span> syslog</span></code></div><div class="spec-doc"><p>The type for syslog</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-syslog"><a href="#val-syslog" class="anchor"></a><code><span><span class="keyword">val</span> syslog : <span><a href="#type-syslog">syslog</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Implementation of the <a href="#type-syslog"><code>syslog</code></a> type.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-syslog_udp"><a href="#val-syslog_udp" class="anchor"></a><code><span><span class="keyword">val</span> syslog_udp : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-syslog">syslog</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Emit log messages via UDP.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-syslog_tcp"><a href="#val-syslog_tcp" class="anchor"></a><code><span><span class="keyword">val</span> syslog_tcp : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-syslog">syslog</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Emit log messages via TCP.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-syslog_tls"><a href="#val-syslog_tls" class="anchor"></a><code><span><span class="keyword">val</span> syslog_tls : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-kv_ro">kv_ro</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-syslog">syslog</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Emit log messages via TLS, using the credentials (private key, certificate, trust anchor) provided in the KV_RO.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-monitoring"><a href="#val-monitoring" class="anchor"></a><code><span><span class="keyword">val</span> monitoring : <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Monitoring</p><p>Monitor metrics to a remote Influx host, also allow adjustments to log sources and levels. The provided <code>stack</code> should not be publicly reachable.</p></div></div><h3 id="conduit-configuration"><a href="#conduit-configuration" class="anchor"></a>Conduit configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-conduit"><a href="#type-conduit" class="anchor"></a><code><span><span class="keyword">type</span> conduit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conduit"><a href="#val-conduit" class="anchor"></a><code><span><span class="keyword">val</span> conduit : <span><a href="#type-conduit">conduit</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-conduit_direct"><a href="#val-conduit_direct" class="anchor"></a><code><span><span class="keyword">val</span> conduit_direct : <span><span class="optlabel">?tls</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-conduit">conduit</a> <a href="#type-impl">impl</a></span></span></code></div></div><h3 id="mimic-devices"><a href="#mimic-devices" class="anchor"></a>Mimic devices</h3><p>For some implementations which requires to communicate with an external resources (such as a webserver or a git server), we must hide the underlying implementations that depend on the <i>target</i> (such as the network stack) and are necessary for these implementations.</p><p>The aim of <code>mimic</code> is to offer first of all the ability to initiate a TCP/IP connection independently of the chosen <i>target</i> (see <a href="#val-mimic_happy_eyeballs"><code>mimic_happy_eyeballs</code></a>).</p><p>The resulting <i>device</i> can then be composed with other protocols like TLS, Git or HTTP and it is through this resulting <i>device</i> that other devices can initiate an internet connection to a peer (like a webserver or a Git server).</p><div class="odoc-spec"><div class="spec type anchored" id="type-mimic"><a href="#type-mimic" class="anchor"></a><code><span><span class="keyword">type</span> mimic</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mimic"><a href="#val-mimic" class="anchor"></a><code><span><span class="keyword">val</span> mimic : <span><a href="#type-mimic">mimic</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mimic_happy_eyeballs"><a href="#val-mimic_happy_eyeballs" class="anchor"></a><code><span><span class="keyword">val</span> mimic_happy_eyeballs : 
  <span><span><a href="#type-stackv4v6">stackv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-happy_eyeballs">happy_eyeballs</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-dns_client">dns_client</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-mimic">mimic</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>mimic_happy_eyeballs stackv4v6 happy_eyeballs dns_client</code> creates a device which initiate a global <i>happy-eyeballs</i> loop. By this way, an underlying instance works to initiate a TCP/IP connection from an IP address or a domain-name.</p><p>For the domain-name resolution, we ask the <i>happy-eyeballs</i> instance to resolve the given domain-name <i>via</i> its DNS client.</p><p>The resulting <i>device</i> can be used <b>and</b> re-used to for any <i>clients</i> which need to initiate a connection (like <a href="#val-alpn_client"><code>alpn_client</code></a> or <a href="#val-git_tcp"><code>git_tcp</code></a>).</p></div></div><h3 id="http-configuration"><a href="#http-configuration" class="anchor"></a>HTTP configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-http"><a href="#type-http" class="anchor"></a><code><span><span class="keyword">type</span> http</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http"><a href="#val-http" class="anchor"></a><code><span><span class="keyword">val</span> http : <span><a href="#type-http">http</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cohttp_server"><a href="#val-cohttp_server" class="anchor"></a><code><span><span class="keyword">val</span> cohttp_server : <span><span><a href="#type-conduit">conduit</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-http">http</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>cohttp_server</code> starts a Cohttp server.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-httpaf_server"><a href="#val-httpaf_server" class="anchor"></a><code><span><span class="keyword">val</span> httpaf_server : <span><span><a href="#type-conduit">conduit</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-http">http</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>httpaf_server</code> starts a http/af server.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-http_client"><a href="#type-http_client" class="anchor"></a><code><span><span class="keyword">type</span> http_client</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http_client"><a href="#val-http_client" class="anchor"></a><code><span><span class="keyword">val</span> http_client : <span><a href="#type-http_client">http_client</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cohttp_client"><a href="#val-cohttp_client" class="anchor"></a><code><span><span class="keyword">val</span> cohttp_client : <span><span><a href="#type-resolver">resolver</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-conduit">conduit</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-http_client">http_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>cohttp_server</code> starts a Cohttp server.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-http_server"><a href="#type-http_server" class="anchor"></a><code><span><span class="keyword">type</span> http_server</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http_server"><a href="#val-http_server" class="anchor"></a><code><span><span class="keyword">val</span> http_server : <span><a href="#type-http_server">http_server</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-paf_server"><a href="#val-paf_server" class="anchor"></a><code><span><span class="keyword">val</span> paf_server : <span><span class="label">port</span>:<span>int <a href="#type-runtime_arg">runtime_arg</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-http_server">http_server</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>paf_server ~port tcpv4v6</code> creates an instance which will start to <i>listen</i> on the given <code>port</code>. With this instance and the produced module <code>HTTP_server</code>, the user can initiate:</p><ul><li>a simple HTTP server</li><li>a simple HTTPS server (with a TLS configuration)</li><li>a simple ALPN (<code>http/1.1</code> &amp; <code>h2</code>) server with TLS</li></ul><p>This is a simple example of how to launch an HTTP server: <b>unikernel.ml</b></p><pre class="language-ocaml"><code>open Cmdliner

let port =
  let doc = &quot;Port of the HTTP service.&quot; in
  Arg.(value &amp; opt int 8080 &amp; info [ &quot;p&quot;; &quot;port&quot; ])

module Make (HTTP_server : Paf_mirage.S with type ipaddr = Ipaddr.t) =
struct
  let error_handler (_ipaddr, _port) ?request:_ _error _send = ()

  let request_handler :
      HTTP_server.TCP.flow -&gt; Ipaddr.t * int -&gt; Httpaf.Reqd.t -&gt; unit =
   fun _socket (_ipaddr, _port) reqd -&gt;
    let contents = &quot;Hello World!\n&quot; in
    let headers =
      Httpaf.Headers.of_list
        [
          (&quot;content-length&quot;, string_of_int (String.length contents));
          (&quot;content-type&quot;, &quot;text/plain&quot;);
          (&quot;connection&quot;, &quot;close&quot;);
        ]
    in
    let response = Httpaf.Response.create ~headers `OK in
    Httpaf.Reqd.respond_with_string reqd response contents

  let start http_server port =
    let service =
      HTTP_service.http_service ~error_handler request_handler
    in
    let (`Initialized thread) = HTTP_server.serve service http_server in
    thread
end</code></pre><p><b>config.ml</b></p><pre class="language-ocaml"><code>open Mirage

let port = Runtime_arg.create ~pos:__POS__ &quot;Unikernel.port&quot;
let main = main &quot;Unikernel.Make&quot; (http_server @-&gt; job)
let stackv4v6 = generic_stackv4v6 default_network
let http_server = paf_server ~port (tcpv4v6_of_stackv4v6 stackv4v6)

let () =
  register &quot;main&quot;
    ~runtime_args:[ Runtime_arg.v port ]
    [ main $ http_server ]</code></pre></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-alpn_client"><a href="#type-alpn_client" class="anchor"></a><code><span><span class="keyword">type</span> alpn_client</span></code></div><div class="spec-doc"><p>Abstract type for ALPN HTTP clients</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-alpn_client"><a href="#val-alpn_client" class="anchor"></a><code><span><span class="keyword">val</span> alpn_client : <span><a href="#type-alpn_client">alpn_client</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-paf_client"><a href="#val-paf_client" class="anchor"></a><code><span><span class="keyword">val</span> paf_client : <span><span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-mimic">mimic</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-alpn_client">alpn_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>paf_client tcpv4v6 dns</code> creates an ALPN device which can do HTTP (<code>http/1.1</code> &amp; <code>h2</code>) requests as a HTTP client. The device allocated represents values required to initiate a connection to HTTP webservers. The user can, then, use the module <code>Http_mirage_client.request</code> to communicate with HTTP webservers. This is an example of how to use the ALPN devices:</p><p><b>unikernel.ml</b></p><pre class="language-ocaml"><code>module Make (HTTP_client : Http_mirage_client.S) = struct
  let start http =
    Http_mirage_client.request http &quot;https://google.com&quot;
      (fun _response buf str -&gt; Buffer.add_string buf str ; Lwt.return buf)
      (Buffer.create 0x100) &gt;&gt;= function
    | Ok (response, buf) -&gt;
      let body = Buffer.contents buf in
      ...
    | Error _ -&gt; ...
end</code></pre><p><b>config.ml</b></p><pre class="language-ocaml"><code>open Mirage

let main = main &quot;Unikernel.Make&quot; (alpn_client @-&gt; job)
let stackv4v6 = generic_stackv4v6 default_network
let he = generic_happy_eyeballs stack
let dns = generic_dns_client stack he

let alpn_client =
  let mimic = mimic_happy_eyeballs stackv4v6 he dns in
  paf_client (tcpv4v6_of_stackv4v6 stackv4v6) mimic

let () = register &quot;main&quot; [ main $ alpn_client ]</code></pre></div></div><h3 id="argv-configuration"><a href="#argv-configuration" class="anchor"></a>Argv configuration</h3><div class="odoc-spec"><div class="spec type anchored" id="type-argv"><a href="#type-argv" class="anchor"></a><code><span><span class="keyword">type</span> argv</span><span> = <a href="../Functoria/index.html#type-argv">Functoria.argv</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-argv"><a href="#val-argv" class="anchor"></a><code><span><span class="keyword">val</span> argv : <span><a href="#type-argv">argv</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_argv"><a href="#val-default_argv" class="anchor"></a><code><span><span class="keyword">val</span> default_argv : <span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>default_argv</code> is a dynamic argv implementation which attempts to do something reasonable based on the target.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_argv"><a href="#val-no_argv" class="anchor"></a><code><span><span class="keyword">val</span> no_argv : <span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>no_argv</code> Disable command line parsing and set argv to <code>|&quot;&quot;|</code>.</p></div></div><h3 id="git-client-configuration"><a href="#git-client-configuration" class="anchor"></a>Git client configuration</h3><p>Users can connect to a remote Git repository in many ways:</p><ul><li>TCP/IP</li><li>HTTP</li><li>HTTP + TLS</li><li>SSH</li></ul><p>The devices defined below define these in composable ways. The <code>git_client impl</code> returned from them can be passed to Git or Irmin in order to be able to <i>fetch</i> and <i>push</i> from/into a Git repository.</p><p>The user is able to restrict or enlarge protocol possibilities needed for its application. For instance, the user is able to restrict only the SSH connection to communicate with a Git repository or the user can handle TCP/IP and SSH as possible protocols to communicate with a peer.</p><p>For instance, a device which is able to communicate <i>via</i> TCP/IP and SSH can be implemented like:</p><pre class="language-ocaml"><code>let he = generic_happy_eyeballs stack
let dns = generic_dns_client stack he

let git_client =
  let mimic = mimic_happy_eyeballs stackv4v6 he dns in
  let ssh =
    git_ssh ~key ~password (tcpv4v6_of_stackv4v6 stackv4v6) mimic
  in
  let tcp = git_tcp (tcpv4v6_of_stackv4v6 stackv4v6) mimic in
  merge_git_clients ssh tcp</code></pre><div class="odoc-spec"><div class="spec type anchored" id="type-git_client"><a href="#type-git_client" class="anchor"></a><code><span><span class="keyword">type</span> git_client</span></code></div><div class="spec-doc"><p>The type for devices that implement the Git protocol.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-git_client"><a href="#val-git_client" class="anchor"></a><code><span><span class="keyword">val</span> git_client : <span><a href="#type-git_client">git_client</a> <a href="#type-typ">typ</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-merge_git_clients"><a href="#val-merge_git_clients" class="anchor"></a><code><span><span class="keyword">val</span> merge_git_clients : <span><span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>merge_git_clients a b</code> is a device that can connect to remote Git repositories using either the device <code>a</code> or the device <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-git_tcp"><a href="#val-git_tcp" class="anchor"></a><code><span><span class="keyword">val</span> git_tcp : <span><span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-mimic">mimic</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>git_tcp tcpv4v6 dns</code> is a device able to connect to a remote Git repository using TCP/IP.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-git_ssh"><a href="#val-git_ssh" class="anchor"></a><code><span><span class="keyword">val</span> git_ssh : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?authenticator</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?key</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?password</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-mimic">mimic</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>git_ssh ?group ?authenticator ?key ?password tcpv4v6 dns</code> is a device able to connect to a remote Git repository using an SSH connection with the given private <code>key</code> or <code>password</code>. The identity of the remote Git repository can be verified using <code>authenticator</code>.</p><p>The format of the private key is: <code>&lt;type&gt;:&lt;seed or b64 encoded&gt;</code>. <code>&lt;type&gt;</code> can be <code>rsa</code> or <code>ed25519</code> and, if the type is RSA, we expect the <b>seed</b> of the private key. Otherwise (if the type is Ed25519), we expect the b64-encoded private key.</p><p>The format of the authenticator is <code>SHA256:&lt;b64-encoded-public-key&gt;</code>, the output of:</p><pre class="language-ocaml"><code>$ ssh-keygen -lf &lt;(ssh-keyscan -t rsa|ed25519 remote 2&gt;/dev/null)</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-git_http"><a href="#val-git_http" class="anchor"></a><code><span><span class="keyword">val</span> git_http : 
  <span><span class="optlabel">?group</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?authenticator</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?headers</span>:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-tcpv4v6">tcpv4v6</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-mimic">mimic</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-git_client">git_client</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>git_http ?group ?authenticator ?headers tcpv4v6 dns</code> is a device able to connect to a remote Git repository via an HTTP(S) connection, using the provided HTTP <code>headers</code>. The identity of the remote Git repository can be verified using <code>authenticator</code>.</p><p>The format of it is:</p><ul><li><code>none</code> no authentication</li><li>key(:&lt;hash&gt;)?:&lt;b64-encoded fingerprint&gt; to authenticate via the key fingerprint</li><li>cert(:&lt;hash&gt;)?:&lt;b64-encoded fingerprint&gt; to authenticate via the cert fingerprint</li><li>trust-anchor(:&lt;der-encoded cert&gt;)+ to authenticate via a list of certificates</li><li>By default, we use X.509 trust anchors extracted from Mozilla's NSS</li></ul></div></div><h3 id="other-devices"><a href="#other-devices" class="anchor"></a>Other devices</h3><div class="odoc-spec"><div class="spec value anchored" id="val-job"><a href="#val-job" class="anchor"></a><code><span><span class="keyword">val</span> job : <span><a href="#type-job">job</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>job</code> is the combinator for representing main tasks.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-noop"><a href="#val-noop" class="anchor"></a><code><span><span class="keyword">val</span> noop : <span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>noop</code> is a job that does nothing, has no dependency and returns <code>()</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-runtime_args"><a href="#val-runtime_args" class="anchor"></a><code><span><span class="keyword">val</span> runtime_args : <span><span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>runtime_args argv</code> is a job that loads argv.</p></div></div><h3 id="application-registering"><a href="#application-registering" class="anchor"></a>Application registering</h3><div class="odoc-spec"><div class="spec value anchored" id="val-register"><a href="#val-register" class="anchor"></a><code><span><span class="keyword">val</span> register : 
  <span><span class="optlabel">?argv</span>:<span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reporter</span>:<span><a href="#type-reporter">reporter</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sleep</span>:<span><a href="#type-sleep">sleep</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ptime</span>:<span><a href="#type-ptime">ptime</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?mtime</span>:<span><a href="#type-mtime">mtime</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?random</span>:<span><a href="#type-random">random</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:<span>[ `Auto <span>| `None</span> <span><span>| `Some</span> of string</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>register ~argv ~reporter ~src name jobs</code> registers the application named by <code>name</code> which will executes the given <code>jobs</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">argv</span> <p>Configure command-line argument parsing. The default parser is <a href="#val-default_argv"><code>default_argv</code></a>. To disable command-line parsing, use <a href="#val-no_argv"><code>no_argv</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">reporter</span> <p>Configure logging. The default log reporter is <a href="#val-default_reporter"><code>default_reporter</code></a>. To disable logging, use <a href="#val-no_reporter"><code>no_reporter</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">sleep</span> <p>Configure the sleep. The default is <a href="#val-default_sleep"><code>default_sleep</code></a>. To disable the timer, use <a href="#val-no_sleep"><code>no_sleep</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">ptime</span> <p>Configure the POSIX clock. The default is <a href="#val-default_ptime"><code>default_ptime</code></a>. To disable the POSIX clock, use <a href="#val-no_ptime"><code>no_ptime</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mtime</span> <p>Configure the monotonic clock. The default is <a href="#val-default_mtime"><code>default_mtime</code></a>. To disable the monotonic clock, use <a href="#val-no_mtime"><code>no_mtime</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">random</span> <p>Configure the random number generator. The default is <a href="#val-default_random"><code>default_random</code></a>. To disable the random device, use <a href="#val-no_random"><code>no_random</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">src</span> <p>The source to use in the generated opam file. If <code>`None</code> no source is output. If <code>`Some mysource</code> the string <code>mysource</code> is used as the source. If <code>`Auto</code> (default) the is guessed from the VCS information.</p></li></ul></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Type"><a href="#module-Type" class="anchor"></a><code><span><span class="keyword">module</span> Type</span><span> = <a href="../Functoria/Type/index.html">Functoria.Type</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Impl"><a href="#module-Impl" class="anchor"></a><code><span><span class="keyword">module</span> Impl</span><span> = <a href="../Functoria/Impl/index.html">Functoria.Impl</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Info"><a href="#module-Info" class="anchor"></a><code><span><span class="keyword">module</span> Info</span><span> = <a href="../Functoria/Info/index.html">Functoria.Info</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Dune"><a href="#module-Dune" class="anchor"></a><code><span><span class="keyword">module</span> Dune</span><span> = <a href="../Functoria/Dune/index.html">Functoria.Dune</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Action"><a href="#module-Action" class="anchor"></a><code><span><span class="keyword">module</span> Action</span><span> = <a href="../Functoria/Action/index.html">Functoria.Action</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Context"><a href="#module-Context" class="anchor"></a><code><span><span class="keyword">module</span> Context</span><span> = <a href="../Functoria/Context/index.html">Functoria.Context</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-connect_err"><a href="#val-connect_err" class="anchor"></a><code><span><span class="keyword">val</span> connect_err : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Project"><a href="#module-Project" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Project/index.html">Project</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Tool"><a href="#module-Tool" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tool/index.html">Tool</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
