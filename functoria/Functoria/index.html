<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Functoria (functoria.Functoria)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">functoria</a> &#x00BB; Functoria</nav><header class="odoc-preamble"><h1>Module <code><span>Functoria</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#the-functoria-dsl">The Functoria DSL</a><ul><li><a href="#defining-toplevel-modules">Defining toplevel modules</a></li><li><a href="#defining-configuration-keys">Defining configuration keys</a></li><li><a href="#defining-applications">Defining applications</a></li></ul></li><li><a href="#useful-module-implementations">Useful module implementations</a></li></ul></nav><div class="odoc-content"><h2 id="the-functoria-dsl"><a href="#the-functoria-dsl" class="anchor"></a>The Functoria DSL</h2><p>Functoria is a DSL to describe a set of modules and functors, their types and how to apply them in order to produce a complete application.</p><p>The main use case is mirage. See the <code>Mirage</code> documentation for details.</p><p>Functoria is a DSL to write configuration files for functor-heavy applications. Such configuration files (imaginatively called <code>config.ml</code>) usually contains three parts: one for defining toplevel modules, one for defining configuration kyes and one for defining applications using these modules and keys.</p><h3 id="defining-toplevel-modules"><a href="#defining-toplevel-modules" class="anchor"></a>Defining toplevel modules</h3><p>To define toplevel modules, use the <a href="#val-main"><code>main</code></a> function. Among its various arguments, it takes the module name and its signature. The type is assembled with the <a href="Type/index.html"><code>Type</code></a> combinators, like the <code>@-&gt;</code> operator, which represents a functor arrow.</p><pre><code>let main = main &quot;Unikernel.Main&quot; (m @-&gt; job)</code></pre><p>This declares that the functor <code>Unikernel.Main</code> takes a module of type <code>m</code> and returns a module of type <a href="DSL/index.html#type-job"><code>DSL.job</code></a>. <code>job</code> has a specific meaning for functoria: it is a module which defines at least a function <code>start</code>, which should have one argument per functor argument and should return <code>unit</code>.</p><p>It is up to the user to ensure that the declaration matches the implementation, or be rewarded by a compiler error later on. If the declaration is correct, everything that follows will be.</p><h3 id="defining-configuration-keys"><a href="#defining-configuration-keys" class="anchor"></a>Defining configuration keys</h3><p>A configuration key is composed of:</p><ul><li><i>name</i> : The name of the value in the program.</li><li><i>description</i> : How it should be displayed/serialized.</li><li><i>stage</i> : Is the key available only at runtime, at configure time or both?</li><li><i>documentation</i> : It is not optional so you should really write it.</li></ul><p>Consider a multilingual application: we want to pass the default language as a parameter. We will use a simple string, so we can use the predefined description <a href="Key/Arg/index.html#val-string"><code>Key.Arg.string</code></a>. We want to be able to define it both at configure and run time, so we use the stage <code>Both</code>. This gives us the following code:</p><pre><code>let lang_key =
  let doc =
    Key.Arg.info ~doc:&quot;The default language for the application.&quot;
      [ &quot;l&quot;; &quot;lang&quot; ]
  in
  Key.create &quot;language&quot; @@ Key.Arg.(opt ~stage:`Both string &quot;en&quot; doc)</code></pre><p>Here, we defined both a long option <code>&quot;--lang&quot;</code> and a short one <code>&quot;-l&quot;</code> (the format is similar to the one used by <a href="http://erratique.ch/software/cmdliner">Cmdliner</a>. In the application code, the value is retrieved with <code>Key_gen.language ()</code>.</p><p>The option is also documented in the <code>&quot;--help&quot;</code> option for both the <code>configure</code> subcommand (at configure time) and <code>./app.exe</code> (at startup time).</p><pre>      -l VAL, --lang=VAL (absent=en) The default language for the application.</pre><h3 id="defining-applications"><a href="#defining-applications" class="anchor"></a>Defining applications</h3><p>To register a new application, use <code>register</code>:</p><pre><code>let () = register &quot;app&quot; [ main $ impl ]</code></pre><p>This function (which should only be called once) takes as argument the name of the application and a list of jobs. The jobs are defined using the <a href="Impl/index.html"><code>Impl</code></a> DSL; for instance the operator <code>$</code> is used to apply the functor <code>main</code> (aka <code>Unikernel.Main</code>) to the default console.</p><p>Once an application is registered, it can be configured and built using command-line arguments.</p><p>Configuration keys we can use be used to switch implementation at configure time. This is done by using the <a href="Key/index.html"><code>Key</code></a> DSL, for instance to check whether <code>lang_key</code> is instanciated with a given string:</p><pre><code>let lang_is &quot;s&quot; = Key.(pure (( = ) s) $ value lang_key)</code></pre><p>Then by using the <a href="#val-if_impl"><code>if_impl</code></a> combinator to choose between two implementations depending on the value of the key:</p><pre><code>let impl = if_impl (is &quot;fi&quot;) finnish_impl not_finnish_implementation</code></pre><div class="odoc-spec"><div class="spec module-type" id="module-type-DSL" class="anchored"><a href="#module-type-DSL" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-DSL/index.html">DSL</a></span><span> = <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="DSL/index.html">DSL</a></span></code></div><div class="spec-doc"><p>The Functoria DSL allows users to describe how to create portable and flexible applications. It allows to pass application parameters easily using command-line arguments either at configure-time or at runtime.</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="module-type-DSL/index.html">DSL</a></span></code></summary><h2 id="combinators_2"><a href="#combinators_2" class="anchor"></a>Combinators</h2><div class="odoc-spec"><div class="spec type" id="type-typ" class="anchored"><a href="#type-typ" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a typ</span></span><span> = <span><span class="type-var">'a</span> <a href="Type/index.html#type-t">Type.t</a></span></span></code></div><div class="spec-doc"><p>The type for values representing module types.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-typ" class="anchored"><a href="#val-typ" class="anchor"></a><code><span><span class="keyword">val</span> typ : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>type t</code> is a value representing the module type <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-(@-&gt;)" class="anchored"><a href="#val-(@-&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (@-&gt;) : <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p>Construct a functor type from a type and an existing functor type. This corresponds to prepending a parameter to the list of functor parameters. For example:</p><pre><code>kv_ro @-&gt; ip @-&gt; kv_ro</code></pre><p>This describes a functor type that accepts two arguments -- a <code>kv_ro</code> and an <code>ip</code> device -- and returns a <code>kv_ro</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-impl" class="anchored"><a href="#type-impl" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a impl</span></span><span> = <span><span class="type-var">'a</span> <a href="Impl/index.html#type-t">Impl.t</a></span></span></code></div><div class="spec-doc"><p>The type for values representing module implementations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-($)" class="anchored"><a href="#val-($)" class="anchor"></a><code><span><span class="keyword">val</span> ($) : <span><span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>m $ a</code> applies the functor <code>m</code> to the module <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-abstract_impl" class="anchored"><a href="#type-abstract_impl" class="anchor"></a><code><span><span class="keyword">type</span> abstract_impl</span><span> = <a href="Impl/index.html#type-abstract">Impl.abstract</a></span></code></div><div class="spec-doc"><p>Same as <a href="#type-impl"><code>impl</code></a> but with hidden type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-dep" class="anchored"><a href="#val-dep" class="anchor"></a><code><span><span class="keyword">val</span> dep : <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-abstract_impl">abstract_impl</a></span></code></div><div class="spec-doc"><p><code>dep t</code> is the (build-time) dependency towards <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-abstract" class="anchored"><a href="#val-abstract" class="anchor"></a><code><span><span class="keyword">val</span> abstract : <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-abstract_impl">abstract_impl</a></span></code></div></div><h2 id="keys_2"><a href="#keys_2" class="anchor"></a>Keys</h2><div class="odoc-spec"><div class="spec type" id="type-key" class="anchored"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a key</span></span><span> = <span><span class="type-var">'a</span> <a href="Key/index.html#type-key">Key.key</a></span></span></code></div><div class="spec-doc"><p>The type for command-line parameters.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-abstract_key" class="anchored"><a href="#type-abstract_key" class="anchor"></a><code><span><span class="keyword">type</span> abstract_key</span><span> = <a href="Key/index.html#type-t">Key.t</a></span></code></div><div class="spec-doc"><p>The type for abstract keys.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-context" class="anchored"><a href="#type-context" class="anchor"></a><code><span><span class="keyword">type</span> context</span><span> = <a href="Key/index.html#type-context">Key.context</a></span></code></div><div class="spec-doc"><p>The type for keys' parsing context. See <a href="Key/index.html#type-context"><code>Key.context</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-value" class="anchored"><a href="#type-value" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a value</span></span><span> = <span><span class="type-var">'a</span> <a href="Key/index.html#type-value">Key.value</a></span></span></code></div><div class="spec-doc"><p>The type for values parsed from the command-line. See <a href="Key/index.html#type-value"><code>Key.value</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-key" class="anchored"><a href="#val-key" class="anchor"></a><code><span><span class="keyword">val</span> key : <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="Key/index.html#type-t">Key.t</a></span></code></div><div class="spec-doc"><p><code>key k</code> is an untyped representation of <code>k</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-if_impl" class="anchored"><a href="#val-if_impl" class="anchor"></a><code><span><span class="keyword">val</span> if_impl : <span><span>bool <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>if_impl v impl1 impl2</code> is <code>impl1</code> if <code>v</code> is resolved to true and <code>impl2</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-match_impl" class="anchored"><a href="#val-match_impl" class="anchor"></a><code><span><span class="keyword">val</span> match_impl : <span><span><span class="type-var">'b</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span> <span>default:<span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span> * <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>match_impl v cases ~default</code> chooses the implementation amongst <code>cases</code> by matching the <code>v</code>'s value. <code>default</code> is chosen if no value matches.</p></div></div><h2 id="pkg_2"><a href="#pkg_2" class="anchor"></a>Package dependencies</h2><p>For specifying opam package dependencies, the type <a href="#type-package"><code>package</code></a> is used. It consists of the opam package name, the ocamlfind names, and optional lower and upper bounds. The version constraints are merged with other modules.</p><div class="odoc-spec"><div class="spec type" id="type-package" class="anchored"><a href="#type-package" class="anchor"></a><code><span><span class="keyword">type</span> package</span><span> = <a href="Package/index.html#type-t">Package.t</a></span></code></div><div class="spec-doc"><p>The type for opam packages.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-scope" class="anchored"><a href="#type-scope" class="anchor"></a><code><span><span class="keyword">type</span> scope</span><span> = <a href="Package/index.html#type-scope">Package.scope</a></span></code></div><div class="spec-doc"><p>Installation scope of a package.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-package" class="anchored"><a href="#val-package" class="anchor"></a><code><span><span class="keyword">val</span> package : 
  <span>?scope:<a href="#type-scope">scope</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?build:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?sublibs:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?libs:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?min:string <span class="arrow">&#45;&gt;</span></span>
  <span>?max:string <span class="arrow">&#45;&gt;</span></span>
  <span>?pin:string <span class="arrow">&#45;&gt;</span></span>
  <span>?pin_version:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-package">package</a></span></code></div><div class="spec-doc"><p>Same as <a href="Package/index.html#val-v"><code>Functoria.Package.v</code></a></p></div></div><h2 id="app_2"><a href="#app_2" class="anchor"></a>Application Builder</h2><p>Values of type <a href="#type-impl"><code>impl</code></a> are tied to concrete module implementation with the <a href="#type-device"><code>device</code></a> and <a href="#val-foreign"><code>foreign</code></a> construct. Module implementations of type <a href="#type-job"><code>job</code></a> can then be <a href="Lib/Make/index.html#val-register">registered</a> into an application builder. The builder is in charge if parsing the command-line arguments and of generating code for the final application. See <a href="Lib/index.html"><code>Functoria.Lib</code></a> for details.</p><div class="odoc-spec"><div class="spec type" id="type-info" class="anchored"><a href="#type-info" class="anchor"></a><code><span><span class="keyword">type</span> info</span><span> = <a href="Info/index.html#type-t">Info.t</a></span></code></div><div class="spec-doc"><p>The type for build information.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-foreign" class="anchored"><a href="#val-foreign" class="anchor"></a><code><span><span class="keyword">val</span> foreign : 
  <span>?packages:<span><a href="#type-package">package</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?packages_v:<span><span><a href="#type-package">package</a> list</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?keys:<span><a href="#type-abstract_key">abstract_key</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?deps:<span><a href="#type-abstract_impl">abstract_impl</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p>Alias for <a href="#val-main"><code>main</code></a>, where <code>?extra_deps</code> has been renamed to <code>?deps</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-main" class="anchored"><a href="#val-main" class="anchor"></a><code><span><span class="keyword">val</span> main : 
  <span>?packages:<span><a href="#type-package">package</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?packages_v:<span><span><a href="#type-package">package</a> list</span> <a href="#type-value">value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?keys:<span><a href="#type-abstract_key">abstract_key</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?extra_deps:<span><a href="#type-abstract_impl">abstract_impl</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>foreign name typ</code> is the functor <code>name</code>, having the module type <code>typ</code>. The connect code will call <code>&lt;name&gt;.start</code>.</p><ul><li>If <code>packages</code> or <code>packages_v</code> is set, then the given packages are installed before compiling the current application.</li><li>If <code>keys</code> is set, use the given <a href="Key/index.html#type-key">keys</a> to parse at configure and runtime the command-line arguments before calling <code>&lt;name&gt;.connect</code>.</li><li>If <code>extra_deps</code> is set, the given list of <a href="#type-abstract_impl">abstract</a> implementations is added as data-dependencies: they will be initialized before calling <code>&lt;name&gt;.connect</code>.</li></ul></div></div><h2 id="devices_2"><a href="#devices_2" class="anchor"></a>Devices</h2><div class="odoc-spec"><div class="spec type" id="type-device" class="anchored"><a href="#type-device" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a device</span></span><span> = <span><span>( <span class="type-var">'a</span>, <a href="#type-abstract_impl">abstract_impl</a> )</span> <a href="Device/index.html#type-t">Device.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-of_device" class="anchored"><a href="#val-of_device" class="anchor"></a><code><span><span class="keyword">val</span> of_device : <span><span><span class="type-var">'a</span> <a href="#type-device">device</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>of_device t</code> is the implementation device <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-impl" class="anchored"><a href="#val-impl" class="anchor"></a><code><span><span class="keyword">val</span> impl : 
  <span>?packages:<span><a href="#type-package">package</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?packages_v:<span><span><a href="#type-package">package</a> list</span> <a href="Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?install:<span>( <span><a href="Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="Install/index.html#type-t">Install.t</a> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?install_v:<span>( <span><a href="Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="Install/index.html#type-t">Install.t</a> <a href="Key/index.html#type-value">Key.value</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?keys:<span><a href="Key/index.html#type-t">Key.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?extra_deps:<span><a href="#type-abstract_impl">abstract_impl</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?connect:<span>( <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> string )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?dune:<span>( <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="Dune/index.html#type-stanza">Dune.stanza</a> list</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?configure:<span>( <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="Action/index.html#type-t">Action.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?files:<span>( <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Fpath</span>.t list</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-typ">typ</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>impl ...</code> is <code>of_device @@ Device.v ...</code></p></div></div><h2 id="jobs_2"><a href="#jobs_2" class="anchor"></a>Jobs</h2><div class="odoc-spec"><div class="spec type" id="type-job" class="anchored"><a href="#type-job" class="anchor"></a><code><span><span class="keyword">type</span> job</span></code></div></div></details></div><div class="odoc-spec"><div class="spec module-type" id="module-type-KEY" class="anchored"><a href="#module-type-KEY" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-KEY/index.html">KEY</a></span><span> =
  <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="Key/index.html">Key</a>
    <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="Key/Arg/index.html#type-converter">Arg.converter</a></span> = <span><span class="type-var">'a</span> <a href="Key/Arg/index.html#type-converter">Key.Arg.converter</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="Key/Arg/index.html#type-t">Arg.t</a></span> = <span><span class="type-var">'a</span> <a href="Key/Arg/index.html#type-t">Key.Arg.t</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Key/Arg/index.html#type-info">Arg.info</a> = <a href="Key/Arg/index.html#type-info">Key.Arg.info</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="Key/index.html#type-value">value</a></span> = <span><span class="type-var">'a</span> <a href="Key/index.html#type-value">Key.value</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="Key/index.html#type-key">key</a></span> = <span><span class="type-var">'a</span> <a href="Key/index.html#type-key">Key.key</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Key/index.html#type-t">t</a> = <a href="Key/index.html#type-t">Key.t</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Key/Set/index.html#type-t">Set.t</a> = <a href="Key/Set/index.html#type-t">Key.Set.t</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="Key/Alias/index.html#type-t">Alias.t</a></span> = <span><span class="type-var">'a</span> <a href="Key/Alias/index.html#type-t">Key.Alias.t</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Key/index.html#type-context">context</a> = <a href="Key/index.html#type-context">Key.context</a></span></span></code></div><div class="spec-doc"><p>The signature for run-time and configure-time command-line keys.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Package" class="anchored"><a href="#module-Package" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Package/index.html">Package</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Representation of opam packages.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Info" class="anchored"><a href="#module-Info" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Info/index.html">Info</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Information about the final application.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Install" class="anchored"><a href="#module-Install" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Install/index.html">Install</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Device" class="anchored"><a href="#module-Device" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Device/index.html">Device</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Signature for functoria devices. A <code>device</code> is a module implementation which contains a runtime state which can be set either at configuration time (by the application builder) or at runtime, using command-line arguments.</p></div></div><h2 id="useful-module-implementations"><a href="#useful-module-implementations" class="anchor"></a>Useful module implementations</h2><div class="odoc-spec"><div class="spec value" id="val-job" class="anchored"><a href="#val-job" class="anchor"></a><code><span><span class="keyword">val</span> job : <span><a href="#type-job">job</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>job</code> is the signature for user's application main module.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-noop" class="anchored"><a href="#val-noop" class="anchor"></a><code><span><span class="keyword">val</span> noop : <span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>noop</code> is an implementation of <a href="#type-job"><code>job</code></a> that holds no state, does nothing and has no dependency.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-argv" class="anchored"><a href="#type-argv" class="anchor"></a><code><span><span class="keyword">type</span> argv</span></code></div><div class="spec-doc"><p>The type for command-line arguments, similar to the usual <code>Sys.argv</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-argv" class="anchored"><a href="#val-argv" class="anchor"></a><code><span><span class="keyword">val</span> argv : <span><a href="#type-argv">argv</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>argv</code> is a value representing <a href="#type-argv"><code>argv</code></a> module types.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sys_argv" class="anchored"><a href="#val-sys_argv" class="anchor"></a><code><span><span class="keyword">val</span> sys_argv : <span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>sys_argv</code> is a device providing command-line arguments by using <code>Sys.argv</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-keys" class="anchored"><a href="#val-keys" class="anchor"></a><code><span><span class="keyword">val</span> keys : 
  <span>?runtime_package:string <span class="arrow">&#45;&gt;</span></span>
  <span>?runtime_modname:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-argv">argv</a> <a href="#type-impl">impl</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-job">job</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>keys a</code> is an implementation of <a href="#type-job"><code>job</code></a> that holds the parsed command-line arguments. By default <code>runtime_package</code> is <code>&quot;functoria-runtime&quot;</code> and <code>runtime_modname</code> is <code>&quot;Functoria_runtime&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span><span class="keyword">val</span> info : <span><a href="#type-info">info</a> <a href="#type-typ">typ</a></span></span></code></div><div class="spec-doc"><p><code>info</code> is a value representing <a href="#type-info"><code>info</code></a> module types.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-app_info" class="anchored"><a href="#val-app_info" class="anchor"></a><code><span><span class="keyword">val</span> app_info : 
  <span>?runtime_package:string <span class="arrow">&#45;&gt;</span></span>
  <span>?build_info:<span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?gen_modname:string <span class="arrow">&#45;&gt;</span></span>
  <span>?modname:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-info">info</a> <a href="#type-impl">impl</a></span></span></code></div><div class="spec-doc"><p><code>app_info</code> is the module implementation whose state contains all the information available at configure-time.</p><ul><li>The value is stored into a generated module name <code>gen_modname</code>: if not set, it is <code>Info_gen</code>.</li><li><code>modname</code> is the name of the runtime module defining values of type <code>info</code>. By default it's <code>Functoria_runtime</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec module" id="module-Type" class="anchored"><a href="#module-Type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Type/index.html">Type</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Representation of module signatures.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Impl" class="anchored"><a href="#module-Impl" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Impl/index.html">Impl</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Key" class="anchored"><a href="#module-Key" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Key/index.html">Key</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Configuration and runtime command-line arguments.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Opam" class="anchored"><a href="#module-Opam" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Opam/index.html">Opam</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Lib" class="anchored"><a href="#module-Lib" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lib/index.html">Lib</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Application builder. API for building libraries to link with <code>config.ml</code></p></div></div><div class="odoc-spec"><div class="spec module" id="module-Tool" class="anchored"><a href="#module-Tool" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tool/index.html">Tool</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Creation of CLI tools to assemble functors.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Engine" class="anchored"><a href="#module-Engine" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Engine/index.html">Engine</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Functoria engine.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-DSL" class="anchored"><a href="#module-DSL" class="anchor"></a><code><span><span class="keyword">module</span> <a href="DSL/index.html">DSL</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The Functoria DSL allows users to describe how to create portable and flexible applications. It allows to pass application parameters easily using command-line arguments either at configure-time or at runtime.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Cli" class="anchored"><a href="#module-Cli" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Cli/index.html">Cli</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Command-line handling.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Action" class="anchored"><a href="#module-Action" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Action/index.html">Action</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Wrapper around <code>Bos</code> which provides a &quot;dry run&quot; feature.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Dune" class="anchored"><a href="#module-Dune" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Dune/index.html">Dune</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Dune files.</p></div></div></div></body></html>