<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Impl (mirage.Functoria.Impl)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">mirage</a> &#x00BB; <a href="../index.html">Functoria</a> &#x00BB; Impl</nav><header class="odoc-preamble"><h1>Module <code><span>Functoria.Impl</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#applications">Applications</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type for values representing module implementations of type <code>'a</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-abstract"><a href="#type-abstract" class="anchor"></a><code><span><span class="keyword">type</span> abstract</span></code></div><div class="spec-doc"><p>The type for untyped <a href="#type-t"><code>t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-device"><a href="#type-device" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a device</span></span><span> = <span><span>(<span class="type-var">'a</span>, <a href="#type-abstract">abstract</a>)</span> <a href="../Device/index.html#type-t">Device.t</a></span></span></code></div><div class="spec-doc"><p>The type for device whose dependencies have type <a href="#type-abstract"><code>abstract</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-abstract"><a href="#val-abstract" class="anchor"></a><code><span><span class="keyword">val</span> abstract : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-abstract">abstract</a></span></code></div><div class="spec-doc"><p><code>abstract i</code> is <code>i</code> with its type erased.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-app_has_no_arguments"><a href="#val-app_has_no_arguments" class="anchor"></a><code><span><span class="keyword">val</span> app_has_no_arguments : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>app_has_no_arguments i</code> is <code>true</code> if the argument list is empty and it is an application, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp</code> is the pretty-printer for module implementations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_abstract"><a href="#val-pp_abstract" class="anchor"></a><code><span><span class="keyword">val</span> pp_abstract : <span><a href="#type-abstract">abstract</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_abstract</code> is the pretty-printer for abstract module implementations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_dot"><a href="#val-pp_dot" class="anchor"></a><code><span><span class="keyword">val</span> pp_dot : <span><a href="#type-abstract">abstract</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_dot</code> outputs the dot representation of module implementations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-($)"><a href="#val-($)" class="anchor"></a><code><span><span class="keyword">val</span> ($) : <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>m $ a</code> applies the functor <code>m</code> to the module <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-if_"><a href="#val-if_" class="anchor"></a><code><span><span class="keyword">val</span> if_ : <span><span>bool <a href="../Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>if_t v t1 t2</code> is <code>t1</code> if <code>v</code> is resolved to true and <code>t2</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-match_"><a href="#val-match_" class="anchor"></a><code><span><span class="keyword">val</span> match_ : <span><span><span class="type-var">'b</span> <a href="../Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">default</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span> * <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>match_t v cases ~default</code> chooses the tementation amongst <code>cases</code> by matching the <code>v</code>'s value. <code>default</code> is chosen if no value matches.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_device"><a href="#val-of_device" class="anchor"></a><code><span><span class="keyword">val</span> of_device : <span><span><span class="type-var">'a</span> <a href="#type-device">device</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_device t</code> is the tementation device <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v"><a href="#val-v" class="anchor"></a><code><span><span class="keyword">val</span> v : 
  <span><span class="optlabel">?packages</span>:<span><a href="../Package/index.html#type-t">Package.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages_v</span>:<span><span><a href="../Package/index.html#type-t">Package.t</a> list</span> <a href="../Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runtime_args</span>:<span><a href="../Runtime_arg/index.html#type-t">Runtime_arg.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?keys</span>:<span><a href="../Key/index.html#type-t">Key.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?extra_deps</span>:<span><a href="#type-abstract">abstract</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?connect</span>:<span>(<span><a href="../Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../Device/index.html#type-code">Device.code</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dune</span>:<span>(<span><a href="../Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Dune/index.html#type-stanza">Dune.stanza</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?configure</span>:<span>(<span><a href="../Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../Action/index.html#type-t">Action.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?files</span>:<span>(<span><a href="../Info/index.html#type-t">Info.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Fpath</span>.t list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Type/index.html#type-t">Type.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>v ...</code> is <code>of_device @@ Device.v ...</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-main"><a href="#val-main" class="anchor"></a><code><span><span class="keyword">val</span> main : 
  <span><span class="optlabel">?pos</span>:<span>(string * int * int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages</span>:<span><a href="../Package/index.html#type-t">Package.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?packages_v</span>:<span><span><a href="../Package/index.html#type-t">Package.t</a> list</span> <a href="../Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runtime_args</span>:<span><a href="../Runtime_arg/index.html#type-t">Runtime_arg.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?keys</span>:<span><a href="../Key/index.html#type-t">Key.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?extra_deps</span>:<span><a href="#type-abstract">abstract</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Type/index.html#type-t">Type.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>main ... name ty</code> is <code>v ... ~connect name ty</code> where <code>connect</code> is <code>&lt;name&gt;.start &lt;args&gt;</code></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Tbl"><a href="#module-Tbl" class="anchor"></a><code><span><span class="keyword">module</span> Tbl</span><span> : <span class="xref-unresolved">Stdlib</span>.Hashtbl.S <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">key</span> = <span class="xref-unresolved">abstract</span></span></span></code></div><div class="spec-doc"><p>Hashtbl of implementations.</p></div></div><h2 id="applications"><a href="#applications" class="anchor"></a>Applications</h2><div class="odoc-spec"><div class="spec type anchored" id="type-f_dev"><a href="#type-f_dev" class="anchor"></a><code><span><span class="keyword">type</span> <span>'b f_dev</span></span><span> = </span><span>{</span></code><ol><li id="type-f_dev.f" class="def record field anchored"><a href="#type-f_dev.f" class="anchor"></a><code><span>f : 'a. <span><span><span class="type-var">'a</span> <a href="#type-device">device</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for iterators on devices.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_left_most_device"><a href="#val-with_left_most_device" class="anchor"></a><code><span><span class="keyword">val</span> with_left_most_device : <span><a href="../Context/index.html#type-t">Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-f_dev">f_dev</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_left_most_device ctx t f</code> applies <code>f</code> on the left-most device in <code>f</code>. <code>If</code> node are resolved using <code>ctx</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simplify"><a href="#val-simplify" class="anchor"></a><code><span><span class="keyword">val</span> simplify : <span><span class="label">full</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="label">context</span>:<a href="../Context/index.html#type-t">Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-abstract">abstract</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-abstract">abstract</a></span></code></div><div class="spec-doc"><p><code>simplify ~full ~context impl</code> simplifies the implementation <code>impl</code> according to keys present in the <code>context</code>.</p><p>If <code>full</code> is <code>true</code>, then the default values of keys are used in their absence. Otherwise, absent keys are left un-simplified.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-eval"><a href="#val-eval" class="anchor"></a><code><span><span class="keyword">val</span> eval : <span><span class="label">context</span>:<a href="../Context/index.html#type-t">Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-abstract">abstract</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Device/Graph/index.html#type-t">Device.Graph.t</a></span></code></div><div class="spec-doc"><p><code>eval ~context impl</code> fully evaluates the implementation <code>impl</code> according to keys present in the <code>context</code>. It returns a graph composed only of devices.</p></div></div><p>Collections</p><div class="odoc-spec"><div class="spec type anchored" id="type-label"><a href="#type-label" class="anchor"></a><code><span><span class="keyword">type</span> label</span><span> = </span></code><ol><li id="type-label.If" class="def variant constructor anchored"><a href="#type-label.If" class="anchor"></a><code><span>| </span><span><span class="constructor">If</span> : <span><span class="type-var">_</span> <a href="../Key/index.html#type-value">Key.value</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-label">label</a></span></code></li><li id="type-label.Dev" class="def variant constructor anchored"><a href="#type-label.Dev" class="anchor"></a><code><span>| </span><span><span class="constructor">Dev</span> : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="../Device/index.html#type-t">Device.t</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-label">label</a></span></code></li><li id="type-label.App" class="def variant constructor anchored"><a href="#type-label.App" class="anchor"></a><code><span>| </span><span><span class="constructor">App</span></span></code></li></ol></div><div class="spec-doc"><p>The description of a vertex</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-collect"><a href="#val-collect" class="anchor"></a><code><span><span class="keyword">val</span> collect : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Functoria__.Misc.Monoid</span> <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">t</span> = <span class="type-var">'ty</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-label">label</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'ty</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-abstract">abstract</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'ty</span></span></code></div><div class="spec-doc"><p><code>collect (module M) f g</code> collects the content of <code>f v</code> for each vertex <code>v</code> in <code>g</code>.</p></div></div></div></body></html>
